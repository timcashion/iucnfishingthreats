---
title: "Low cost conservation: Fisheries gear threats to marine species"
author: "Tim Cashion, Travis C. Tai, Vicky W.Y. Lam, Daniel Pauly, and U. Rashid Sumaila"
date: "`r date()`"
output: 
  # bookdown::html_document2:
  #   default
  bookdown::word_document2:
    default
bibliography: MyCollection.bib
always_allow_html: yes
csl: science.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=F, warning=F)
source("./R/common_fxns.R")
#biblio-style: "apalike"
packages <- c("tidyverse", 
              "rgdal",
              "wesanderson",
              "parallel",
              "bookdown",
              "knitr"
              )
ipak(packages)

####Directories####
dir_data <- "./data"
dir_spatial <- "./spatial"
dir_figs <- "./figs"
dir_manuscript_figs <- "./figs/manuscript_figs"
dir_supplemental_figs <- "./figs/supplemental_figs"
dir_spatial_csvs <- "./spatial/csvs"
dir_rasters <- "./spatial/spp_rasters"
dir_output <- "./output"


fig_output <- TRUE
if(fig_output==TRUE){ #Erase existing manuscript figs and re-output
  unlink(paste("./figs/manuscript_figs/", list.files("./figs/manuscript_figs"), sep=""))
}

```

```{r plot-aes}
pal <- wes_palette(name = "Zissou1", n=100, type = c("continuous"))
zissou5 <- wes_palette(name="Zissou1")


theme_set(theme_classic())

cont_fill = 'white'#'grey30' #'grey80'
back_fill =  'white'#'#202A50' #'black' #'#1F2A4F'
cont_color = 'grey60'#'grey30'
#color_grad = c( "#414487", "#2A788E", "#22A884", "#7AD151","#FDE725","#FFC04C")
color_grad = c("#C6DBEF", "#9ECAE1", "#6BAED6","#4292C6" ,"#2171B5", "#084594") #blues
null_colour <- "white"

```

```{r data}

#Establish list of marine species 
all_species <- data.table::fread(file.path(dir_data, paste( "iucn_species_list_", api_version,".csv", sep="")))

marine_species <- read.csv(file.path(dir_data, paste( "spp_marine_from_", api_version,".csv", sep="")))
#### Align with threats and narrative text: ####
species_threats <- read.csv(file.path(dir_data, "species_fishing_threats.csv"), stringsAsFactors = F)
colnames(species_threats) <- gsub(colnames(species_threats), pattern="result\\.", replacement="")
risk_codes <- read.csv(file.path(dir_data, "risk_code_lookup.csv"), stringsAsFactors = F)
species_threats <- species_threats %>% left_join(risk_codes, by=c("category"="code"))
species_threats <- species_threats %>%
  dplyr::select(iucn_sid, class_name, scientific_name, code_current, cat_score) %>%
  unique()


# threatened_status <- c("VU", "CR", "EN")
# species_threats <- species_threats %>% filter(code_current %in% threatened_status)
text_threats <- read_csv(file.path(dir_data, "narrative_threats_output_tidy.csv"))

cell_size <- "05"

spat_files <- list.files(file.path(paste(dir_rasters, "_", cell_size, sep="")))
spat_files <- spat_files[spat_files != "desktop.ini"]
raster_read <- function(filename){
  id <- gsub(filename, pattern="iucn_sid_", replacement = "")
  id <- gsub(id, pattern=".csv", replacement = "")
  spp_rast <- data.table::fread(file.path(paste(dir_rasters, "_", cell_size, sep=""), filename))
  if(nrow(spp_rast)>0){
    spp_rast$iucn_sid <- as.numeric(id)
    return(spp_rast)
  }
}
# spat_list <- parallel::mclapply(spat_files, raster_read)
# spat_list <- bind_rows(spat_list)
# write_csv(spat_list, file.path(dir_data, "spat_list.csv"))
spat_list <- data.table::fread(file.path(dir_data, "spat_list.csv"))

#Get cell ids to match to lon, lat, and water area
# cell_ids <- read.csv(file.path(dir_spatial_csvs, "cell_ids.txt"), header=F, col.names = c("cell_id", "lon", "lat"))
# cell_id_area <- data.table::fread(file.path(dir_spatial_csvs, "cell_id_area_05.csv"))
cell_ids <- read.csv(file.path(dir_spatial_csvs, "cell_id_lon_lat_area.csv"))


# allocated_gear_value <- data.table::fread(file.path(dir_data, "allocated_super_gear_value.csv"))
# allocated_gear_value <- allocated_gear_value %>% 
#   left_join(cell_ids) %>% 
#   left_join(cell_id_area) %>% 
#   mutate(value_km2 = mean_value/water_area)

allocated_gear_profit <- data.table::fread(file.path(dir_data, "allocated_super_gear_profit.csv"))
allocated_gear_profit <- allocated_gear_profit %>% 
  left_join(cell_ids) %>% 
  #left_join(cell_id_area) %>% 
  mutate(catch_km2 = mean_catch/water_area,
         profit_km2 = mean_profit/water_area)

spat_data <- spat_list %>% 
  left_join(cell_ids, by="cell_id") %>%
  mutate(category = if_else(is.na(rgn_category), global_category, rgn_category)) %>% 
  left_join(risk_codes %>% dplyr::select(-c(category)), by=c("category"="code"))

```

Target Journals: Science, Nature, PNAS, Science Advances, Nature Sustainability, Conservation Biology  

Sentence summary: Fishing gear specific threats to marine species demonstrates lower-cost trade-offs between fisheries and conservation goals. 

## Abstract  
Understanding conflicts between objectives of fisheries and conservation is the key to a win-win situation for marine biodiversity and fishers. Many marine species are threatened by harmful interactions with fisheries, but the threats they face are associated with the fishing gears used which are not generalized to all fisheries. Here, we undertake a novel analysis of marine species and their gear-specific threats to evaluate conservation-fisheries trade-offs to identify areas with high competing goals. Gillnet and longline fisheries had the greatest risk to marine species yet achieve relatively low profits, emphasizing the social and ecological inefficiencies of these gears. The majority of the high seas has low fisheries benefits with over 25% of the high seas categorized as areas of 'conservation prioritization' over fisheries.

Keywords: fishing method, IUCN, fishing pressure, conservation

## Introduction

```{r text-values}
iucn_species <- data.table::fread(file.path(dir_data, paste("iucn_species_list_", api_version, ".csv", sep="")))
iucn_species <- iucn_species %>% select(result.taxonid, result.scientific_name) %>% distinct()
unique_species <- length(iucn_species %>% pull(result.scientific_name) %>% unique())

iucn_marine_num <- data.table::fread(file.path(dir_data, paste("spp_marine_from_", api_version, ".csv", sep="")))
iucn_marine_num <- length(iucn_marine_num %>% left_join(iucn_species, by=c("iucn_sid"="result.taxonid")) %>% pull(result.scientific_name) %>% unique())


fishing_threat_num <- length(data.table::fread(file.path(dir_data, "species_fishing_threats.csv")) %>% filter(code=="5.4") %>% left_join(iucn_species, by="result.scientific_name") %>% pull(result.scientific_name) %>% unique())
gear_threat_num <- length(data.table::fread(file.path(dir_data, "narrative_threats_output_tidy.csv")) %>% left_join(iucn_species, by=c("scientific_name"="result.scientific_name")) %>% pull(scientific_name) %>% unique())


trawler_unspec_num <- length(text_threats %>% filter(super_code =="trawl unspec") %>% pull(scientific_name) %>% unique())

#Numbers used in text
fishing_threat_perc <- round(fishing_threat_num/iucn_marine_num * 100, 1)
iucn_marine_num <- prettyNum(iucn_marine_num, big.mark = ",")
fishing_threat_num <- prettyNum(fishing_threat_num, big.mark = ",")
gear_threat_num <- prettyNum(gear_threat_num, big.mark = ",")

```

Fishing is a major threat to many marine species globally [@Jackson2001]. However, different fishing gears are heterogeneous in their spatial extent and their impacts on different species. Therefore, treating different fisheries homogenously with regard to their spatial management likely causes unnecessary conflict between fisheries and conservation priorities, and may impose too high costs without necessarily achieving their intended conservation goals. Here, we aim to clarify (w.c. understand) this by relating fisheries threats related to specific fishing gears and their spatial overlap with species of conservation concern. Recent studies have highlighted the spatial extent of fisheries [@Kroodsma2018a; @Amoroso2018], as well as the fisheries risk to species of conservation concern [@Queiroz2019]. While fisheries pose obvious risks to  both targeted and incidentally captured species [@Lewison2004], they also provide livelihoods and food security to millions and billions, respectively [@FAO2018]. Thus, the goals of fisheries and conservation must be balanced to minimize the costs and maximize the benefits where possible. 

Previous analyses have demonstrated these trade-offs between fisheries and ecosystem health [@Cheung2008]. However, win-win situations are often only possible when using  overly simplified models that do not account for all variables such as employment for fishers [@Cheung2008] or spillover impacts to other areas of importance [@McShane2011]. It is therefore important to consider the different scales at which these conservation plans act and the implicit trade-offs between social and ecological outcomes in many fisheries management plans [@McShane2011]. In addition, taking the heterogeneity of fisheries into account can lead to more positive fishery outcomes without compromising conservation goals [@Klein2010]. 

Here, we establish the first estimate of large-scale conservation trade-offs when protecting species from their major fishing gear threats. This analysis is based on `r gear_threat_num` marine species included in the International Union for the Conservation of Nature (IUCN) Red List with *specific* fishing gears listed as threats. We use species' distribution range maps with their threat status [@IUCN2019] and combine them with a spatialized fisheries catch by gear database [@Pauly2015]. We use gear threats by species described by the IUCN, and weight IUCN conservation status on a linear scale (in line with [@OHara2019]) to derive a weighted threat score for all marine areas of the world (Table S1). We then combine this with fisheries catch and profit data by gear type to highlight areas with low-cost trade-offs between fisheries and conservation, and areas of high conservation concern that are also highly important to fisheries where there is likely to be competition between fisheries and conservation objectives. 

## Results

### Fishing threats to IUCN species
For the `r iucn_marine_num` marine species included on the IUCN Red List, fishing is identified by the IUCN as a threat to `r fishing_threat_num` of them (`r fishing_threat_perc`%) (Threat category 5.4: fishing and harvesting aquatic resources). This threat is from both large- and small-scale sectors, and from intentional and unintentional capture (Figure \@ref(fig:iucn-fig-combined)A). According to the identified threats, the small-scale sector is a threat to a greater number of species than the intentional or unintentional capture by the large-scale sector. Interestingly, the impacts of fishing are identified to be low or unknown on most of the species, whereas medium or high fishing impacts are identified on only very few species. 

```{r fishing-threat}

# fig.cap="Threat to species by level of impact and IUCN fisheries impact category", fig.width=8

fishing_threats <- read.csv(file.path(dir_data, "species_fishing_threats.csv"))
colnames(fishing_threats) <- gsub(colnames(fishing_threats), pattern="result\\.", replacement="")
fishing_threats$title <- gsub(fishing_threats$title, pattern=" \\[harvest\\]", replacement = "")
fishing_threats$score_numeric <- gsub(fishing_threats$score, pattern=".*\\: ", replacement="")
fishing_threats$score_numeric <- as.numeric(fishing_threats$score_numeric)
fishing_threats$score <- gsub(fishing_threats$score, pattern="\\: .*", replacement="")
fishing_threats$score[fishing_threats$score=="Past Impact"] <- "No/Negligible Impact"
fishing_threats$score[fishing_threats$score=="(Not specified)"] <- "Unknown"
fishing_threats$score[is.na(fishing_threats$score)] <- "Unknown"
fishing_threats$score <- fct_relevel(fishing_threats$score, c("No/Negligible Impact", "Unknown", "Low Impact", "Medium Impact", "High Impact"))

fishing_threats$title <- gsub(fishing_threats$title, pattern=": ", replacement=":\n")

fishing_threats_plot <- fishing_threats %>% 
  filter(code != "5.4") %>% 
  group_by(title, score) %>% 
  summarize(Count=n()) %>% 
  ungroup() %>% 
  mutate(title = fct_reorder(title, Count)) %>% 
  ggplot(aes(x=title, y=Count, fill=score)) +
  scale_fill_manual(values=zissou5) + 
  geom_col() + 
  coord_flip() +
  xlab("Threat") +
  ylab("Number of species") + 
  labs(fill="Level of impact") +
  scale_x_discrete(expand=c(0,0)) +
  scale_y_continuous(expand=c(0,0)) +
  theme(axis.text.y = element_text(size=12),
      axis.title.y = element_text(size=12),
      legend.text =  element_text(size=12),
      legend.title =  element_text(size=12)) +
  NULL
# fishing_threats_plot
# if(fig_output==TRUE){
#   ggsave(file.path(dir_manuscript_figs, "fishing-threat.png"), dpi=300, width=8)
# }
```

Within the Red List, trawls are identified as a gear threat for more than 2,500 marine species (Figure \@ref(fig:iucn-fig-combined)B). While many of the species caught by this gear type have an elevated risk of extinction (Near Threatened and higher), most are either Least Concern or Data Deficient within these gear types. The 'gear types' that appear in most species threat description are generally more vague gear terms (e.g., 'trawls' and 'nets') and could be attributable to several types of fishing gear (e.g., trawl nets, gillnets, seine nets all fall under 'nets'). The more specific gear categories identified are used in the remaining parts of the analysis (Table S2). 


```{r gear-threats, fig.cap="Fishing gear terms by number of species where that gear is mentioned in 'Threats' or 'Use and Trade' text"}
text_threats <- read.csv(file.path(dir_data, "narrative_threats_output_tidy.csv"))

exclude <- "trawlers"

iucn_cols <- IUCNpalette::iucn_palette(category="All", exclude=c("NE", "CO")) 

iucn_species <- all_species %>% dplyr::select(result.taxonid, result.category)
risk_codes <- read.csv(file.path(dir_data, "risk_code_lookup.csv"), stringsAsFactors = F)
iucn_species <- iucn_species %>% left_join(risk_codes, by=c("result.category"="code"))

gear_terms_threats_plot <- text_threats %>% 
  filter(!super_code %in% exclude) %>% 
  left_join(iucn_species , by=c("iucn_sid"="result.taxonid")) %>% 
  filter(code_current != "EX") %>% 
  group_by(super_code, code_current) %>% 
  summarize(Count=sum(threat)) %>% 
  ungroup() %>% 
  group_by(super_code) %>% 
  mutate(Total=sum(Count)) %>% 
  ungroup() %>% 
  mutate(super_code = fct_reorder(str_to_sentence(super_code), Total)) %>% 
  mutate(code_current = fct_relevel(code_current, c("DD", "LC", "NT", "VU", "EN", "CR", "EX"))) %>% 
  mutate(code_current = fct_relevel(code_current, rev(c("DD", "LC", "NT", "VU", "EN", "CR", "EX")))) %>% 
  ggplot(aes(x=super_code, y=Count, fill=code_current)) +
  geom_col() + 
  coord_flip() +
  xlab("Fishing gear threat") +
  ylab("Number of species") + 
  labs(fill="IUCN category") + 
  scale_fill_manual(values = rev(iucn_cols)) +
  scale_x_discrete(expand=c(0,0)) +
  scale_y_continuous(expand=c(0,0)) +
  theme(axis.text.y = element_text(size=12),
        axis.title.y = element_text(size=12),
        legend.text =  element_text(size=12),
        legend.title =  element_text(size=12)) +
  NULL
# gear_terms_threats_plot
# if(fig_output==TRUE){
#   ggsave(file.path(dir_manuscript_figs, "gear-threats.png"), dpi=300)
# }
```

From the gear types we have previously identified (Figure \@ref(fig:iucn-fig-combined)C) we see again that bottom trawl fisheries are associated with the largest number of Red List species. However, we see these species are mainly in the Data Deficient, Least Concern, and Near Threatened categories while gillnet gears have the most number of species in the Threatened categories (Vulnerable, Endangered, and Critically Endangered).  

```{r gear-threat-col-chart, fig.cap="Gear threats across current IUCN Red List status and gear types", fig.width=10, fig.height=5}

text_threats <- read.csv(file.path(dir_data, "narrative_threats_output_tidy.csv")) 

weighted_gear_threats <- left_join(species_threats, text_threats)
weighted_gear_threats <- weighted_gear_threats %>% 
  mutate(gear_threat = threat*cat_score) %>% 
  filter(is.na(super_code)==F)
  

weighted_gear_threats <- weighted_gear_threats %>% 
  mutate(gear_threat = threat*cat_score)
gears_to_include <- c("Bottom trawl", "Purse seine", "Longline", "Small scale", "Gillnet")

weighted_gear_threats_plot2 <- weighted_gear_threats %>% 
  group_by(super_code, code_current) %>% 
  summarize(Count=sum(threat, na.rm=TRUE)) %>% 
  ungroup() %>% 
  mutate(super_code = fct_reorder(str_to_sentence(super_code), Count)) %>% 
  mutate(code_current = fct_relevel(code_current, c("DD", "LC", "NT", "VU", "EN", "CR", "EX"))) %>% 
  filter(super_code %in% gears_to_include) %>% 
  ggplot(aes(x=super_code, y=Count, fill=super_code)) +
  geom_col() + 
  xlab("") +
  ylab("Number of species") + 
  labs(fill="Gear type") + 
  facet_wrap(~code_current, nrow=1) + 
  theme(strip.text = element_text(size=12), 
        #strip.background =element_rect(fill=iucn_cols),
        axis.text.x=element_blank(), 
        axis.text.y = element_text(size=12),
        axis.title.y = element_text(size=12),
        legend.text =  element_text(size=12),
        legend.title =  element_text(size=12)) +
  #theme(strip.background = element_rect(fill=iucn_cols), strip.text = element_text(), axis.text.x=element_blank()) + #Fill by IUCN category is quite complicated. Leaving this for now. 
  scale_fill_manual(values = wes_palette("Darjeeling2")) +
  #scale_fill_manual(values = c("#A6C3DD", "#F6D5B9", "#FFFF00")) +
  scale_x_discrete(expand=c(0,0)) +
  scale_y_continuous(expand=c(0,0)) +
  NULL
# weighted_gear_threats_plot2
# if(fig_output==TRUE){
#   ggsave(file.path(dir_manuscript_figs, "gear-threat-col-chart.png"), dpi=300, width=10, height=5)
# }

```

```{r iucn-fig-combined, fig.cap= "IUCN fishing gear threats: species categorized by fishing gear threat (A); fishing gear threats by gear types listed (B); and identified gear types by threat status (C). Note: DD: Data Deficient; LC: Least Concern; NT: Near Threatened; VU: Vulnerable; EN: Endangered; CR: Critically Endangered.", fig.height=8, fig.width=12, dpi=400}

#Gear threats across current IUCN Red List status and gear types

cowplot::plot_grid(
  cowplot::plot_grid(fishing_threats_plot,
  gear_terms_threats_plot, nrow=1, labels=c("A", "B")),
  weighted_gear_threats_plot2,
  nrow=2, 
  align = "v",
  rel_widths = c(1, 2),
  rel_heights = 1, 
  labels=c("","C"))

if(fig_output==TRUE){
  ggsave(file.path(dir_manuscript_figs, "iucn_panel.png"), height = 8, width=12, dpi=300)
}
```


```{r harmonized-threats-data}
files <- list.files(dir_output)[grepl(list.files(dir_output), pattern="_SAU_IUCN_threat_05.csv")]

files <- file.path(dir_output, files)
harmonized_list <- lapply(files, data.table::fread)
harmonized_threats <- bind_rows(harmonized_list)
harmonized_threats <- harmonized_threats %>% group_by(lon, lat) %>% 
  summarize(profit = sum(profit, na.rm=TRUE),
            catch=sum(catch, na.rm=TRUE),
            n=sum(n, na.rm=TRUE),
            weighted_score=sum(weighted_score, na.rm=TRUE)) %>% 
  ungroup() %>% 
  mutate(weighted_score_norm = 100*(weighted_score/max(weighted_score)))

```




```{r gear-measures-summary}
sau_gear_types <- unique(allocated_gear_profit$super_code)
iucn_gear_types <- unique(text_threats$super_code)
gear_types <- iucn_gear_types[grep(iucn_gear_types, pattern=paste(sau_gear_types, collapse="|"))]

gear_threats <- spat_data %>% 
  left_join(text_threats) %>% 
  group_by(lon, lat, super_code) %>% 
  summarize(n = sum(presence, na.rm = T),
            weighted_score = sum(cat_score, na.rm = T)) %>% 
  ungroup()

density_data <- full_join(allocated_gear_profit, gear_threats) %>% 
  filter(super_code != "other") %>% 
  filter(super_code %in% gear_types) %>% 
  mutate(weighted_score = ifelse(is.na(weighted_score), 0, weighted_score),
         profit_km2 = ifelse(is.na(profit_km2), 0, profit_km2),
         n = ifelse(is.na(n), 0, n)) %>% 
  mutate(super_code = fct_drop(super_code)) %>% 
  mutate(profit_km2_per_n = profit_km2/n,
         profit_km2_per_weight = profit_km2/weighted_score,
         score_per_dollar = weighted_score/profit_km2)


#Summary table
summary_tab <- density_data %>% 
  filter(is.na(mean_profit)==F & is.na(weighted_score)==F) %>% 
  group_by(super_code) %>% 
  mutate(biodiv_risk = weighted_score/n) %>% 
  summarize(profit_km2 = round(mean(profit_km2),2),
            n = round(mean(n),1), 
            weighted_score = round(mean(weighted_score),2),
            biodiv_risk = round(mean(biodiv_risk, na.rm=TRUE),2)) 

#  mutate(profit_km2_per_weight = round(profit_km2/weighted_score,2))
#Text values:
#Mean and median by gear type
bt_profit <- round(summary_tab %>% filter(super_code=="bottom trawl") %>% pull(profit_km2),0)
bt_risk <- summary_tab %>% filter(super_code=="bottom trawl") %>% pull(biodiv_risk)
bt_n <- round(summary_tab %>% filter(super_code=="bottom trawl") %>% pull(n), 0)
ll_profit <- round(summary_tab %>% filter(super_code=="longline") %>% pull(profit_km2),0)
ll_risk <- summary_tab %>% filter(super_code=="longline") %>% pull(biodiv_risk)



summary_tab <- summary_tab %>% 
  mutate(super_code = str_to_sentence(super_code))
colnames(summary_tab) <- c("Gear type", "Profit ($/km^2^)", "Number of species", "Weighted Threat Score", "Biodiversity Risk Score")


```


### Low-cost solutions to gear threats and easy conservation wins

Globally, annual fisheries profits by bottom trawl fisheries are estimated to be at an average of \$`r toString(bt_profit)` real USD per km^2^ of area fished (Table \@ref(tab:gear-summary-table)). However, an average of `r toString(bt_n)` species are targeted by bottom trawls in each of the half degree by half degree grids cells with this gear, with an average biodiversity risk score of Near Threatened (`r toString(bt_risk)`). Taken together, their generally high value catches make them perform relatively well overall. In contrast, longline fisheries have low profits per area occupied (\$`r toString(ll_profit)`) as they fish over a large spatial area. While they operate in areas with a similar biodiversity risk score as bottom trawl fisheries (`r toString(ll_risk)`), they do so with much lower returns meaning they produce less fisheries profits for their relative conservations risk (weighted threat score) than bottom trawl fisheries. 

```{r gear-summary-table}
knitr::kable(summary_tab, caption= "Mean values of measures of fisheries conservation concern and profit by gear type at a 0.5° by 0.5° scale.")
```

We separated the whole world into half degree by half degree grid cells. If we consider each spatial cell an independently managed grid, we can examine the trade-offs required in each cell based on their fisheries profits and conservation value (Figure \@ref(fig:conceptual-figure-gears)). Although bottom trawl fisheries operate in many spatial cells of conservation concern (high 'weighted threat score' values), they also generate substantial profits from these fisheries. Gillnets, alternatively, have a large number of cells that are below the median value for fisheries profits and have high weighted threat scores. Pelagic trawls have low weighted threat scores overall and thus the reduction in their use may not lead to large conservation gains. However, pelagic trawls are estimated to be non-profitable ($-133.66/km2) and it means this gear type is inefficient. Hence, persistent use of this gear type may not be economically beneficial to human well-being. 

The six major gear types included here (Table \@ref(tab:gear-summary-table)) together account for 92% of global fisheries catches (landings and discards) [@Cashion2018a]. Bottom trawls, gillnets, and longlines are used in large extent (i.e., have many more cells) where the weighted threat score is higher than the median, especially in contrast to pelagic trawls, purse seines and small-scale gears. Among these higher impact gears, the fisheries profit gained in each grid cell varies substantially. Interestingly, gillnet fisheries are operating in many areas of high conservation concern with fisheries profits below the median value (across gear types). This demonstrates that the social costs of this gear are higher than previously thought [@Chuenpagdee2003], and the social benefit may not be net positive given their relatively poor private profits achieved (mainly below the median). In contrast, bottom trawl fisheries while overlapping on the weighted threat score dimension with gillnet fisheries, achieve higher profits thus representing a conflict between conservation goals and fisheries goals. Small-scale gears and purse seine have mixed results with weighted threat scores not nearly as high as gillnet or bottom trawls, and a mix of high and low profit areas. Pelagic trawls are often used solely for relatively low-value species (from krill to Alaska pollock), but have very low weighted threat scores throughout their range of fisheries profits. 

```{r conceptual-figure-gears, fig.cap="Fisheries profits (log scaled) and weighted score by cell (0.5° by 0.5° grid) for major gear types. Grey dashed lines indicate the median values  (excluding values of 0) across gear types for fisheries profits per km^2^ and weighted threat score."}

sau_gear_types <- unique(allocated_gear_profit$super_code)
iucn_gear_types <- unique(text_threats$super_code)
gear_types <- iucn_gear_types[grep(iucn_gear_types, pattern=paste(sau_gear_types, collapse="|"))]

gear_threats <- spat_data %>% 
  left_join(text_threats) %>% 
  group_by(lon, lat, super_code) %>% 
  summarize(n = sum(presence, na.rm = T),
            weighted_score = sum(cat_score, na.rm = T)) %>% 
  ungroup()

density_data <- full_join(allocated_gear_profit, gear_threats) %>% 
  filter(super_code != "other") %>% 
  filter(super_code %in% gear_types) %>% 
  mutate(super_code = fct_drop(super_code)) %>% 
  mutate(weighted_score = ifelse(is.na(weighted_score), 0, weighted_score),
         profit_km2 = ifelse(is.na(profit_km2), 0, profit_km2),
         n = ifelse(is.na(n), 0, n)) %>% 
  mutate(profit_km2_per_n = profit_km2/n,
         profit_km2_per_weight = profit_km2/weighted_score,
         score_per_dollar = weighted_score/profit_km2) 


plot_data <- density_data %>% 
  filter(super_code != "drifting longlines") %>% 
  mutate(super_code = str_to_sentence(super_code))
#Modified the medians to exclude 0 values. 
median_wts <- median(plot_data %>% filter(weighted_score!=0) %>% pull(weighted_score), na.rm=TRUE) 
median_profitkm2 <- median(plot_data %>% filter(profit_km2!=0) %>% pull(profit_km2), na.rm=TRUE)

line_colour <- "grey50"
plot_data %>% 
  ggplot(aes(x=weighted_score, y=profit_km2, color=super_code)) +
  geom_point(alpha=0.2) + 
  scale_y_log10() + 
  ylab(expression(paste("Profit ($/", km^2))) +
  xlab("Weighted threat score") +
  labs(color="Gear type") + 
  facet_wrap(~super_code) + 
  geom_vline(xintercept = median_wts, lty="dashed", color=line_colour) + 
  geom_hline(yintercept = median_profitkm2, lty="dashed", color=line_colour) +
  theme(strip.background = element_blank()) + 
  theme(legend.position = "none") + 
  NULL

if(fig_output==TRUE){
  ggsave(file.path(dir_manuscript_figs, "conceptual-figure-gears.png"), dpi=300)
}
```


### Protecting the high seas 
Areas beyond national jurisdiction (i.e., the high seas) have recently received increased attention for their protection for biodiversity and fishery gains [@Sumaila2015a; @White2014], while leading to little losses in terms of food security [@Schiller2018]. According to our framework, the high seas have cells in all four quadrants of our conceptual figure (Fig S2), but the majority are "areas of low concern" and "easy wins" (Figure \@ref(fig:high-seas)). This confirms earlier analysis of the lack of importance of high seas fisheries [@Sumaila2015a; @White2014; @Schiller2018], and although the high seas is dominated by areas of low concern, it has vast amounts that fall into 'easy wins' with very few cells in fishery prioritization or fishery competition. Therefore, the question may be changed from which parts of the high seas should we protect, to which parts of the high seas should remain as fishing areas [@Walters1998] if any? 

```{r high-seas, fig.cap="Scatterplot of cells within the High Seas (areas beyond national jurisdiction) according to their categories from our conceptual diagram. Each point is the values for a specific gear type in a 0.5° by 0.5° cell. Dashed lines indicated mean values of all cells (High Seas and EEZs).", fig.width=8}

#Get cell ids to identify HS areas from EEZs
cell_ids <- read.csv(file.path(dir_spatial_csvs, "cell_id_lon_lat_area.csv"))
cell_ids_eezs <- read.csv(file.path(dir_spatial_csvs, "cell_id_eez_fao_area.csv"))
cell_ids_eezs <- cell_ids_eezs %>% select(-water_area) %>% rename(eez_id=area_id)
cell_ids <- left_join(cell_ids, cell_ids_eezs, by="cell_id")

# cell_size <- "05"
# eez_cell_ids <- read_csv(file.path(dir_spatial_csvs, paste("eez_cell_ids_", cell_size, ".csv", sep="")))
# eez_ids <- read.csv(file.path(dir_spatial_csvs, "eez_ids.csv")) %>% 
#   rename(eez_id = EEZID, eez = Name, entity=Entity) %>% 
#   dplyr::select(eez_id, eez, entity)
# 
# eez_ids <- eez_ids %>% 
#   mutate(eez = gsub(eez, pattern="ô", replacement="o"),
#          entity = gsub(entity, pattern="ô", replacement="o"),
#          eez = gsub(eez, pattern="é", replacement="e"),
#          entity = gsub(entity, pattern="é", replacement="e"))
# 
# 
# cell_ids <- read.csv(file.path(dir_spatial_csvs, "cell_ids.txt"), header=F, col.names = c("cell_id", "lon", "lat"))
# cell_ids_area <- read.csv(file.path(dir_spatial_csvs, paste("cell_id_area_", cell_size,".csv", sep="")))
# cell_ids <- cell_ids %>% left_join(cell_ids_area) %>% left_join(eez_cell_ids) %>% left_join(eez_ids)

# cell_ids <- cell_ids %>% 
#   mutate(eez = ifelse(is.na(eez) & water_area>0, "High seas", eez),
#          entity = ifelse(is.na(entity) & water_area>0, "High seas", entity))


harmonized_threats <- bind_rows(harmonized_list)


# harmonized_threats <- harmonized_threats %>% group_by(lon, lat) %>% 
#   summarize(catch=sum(catch, na.rm=TRUE),
#             n=sum(n, na.rm=TRUE),
#             weighted_score=sum(weighted_score, na.rm=TRUE)) %>% 
#   ungroup() %>% 
#   mutate(weighted_score = 100*(weighted_score/max(weighted_score)))
harmonized_threats <- harmonized_threats %>% left_join(cell_ids)
harmonized_threats <- harmonized_threats %>% 
  mutate(catch_km2 = catch/water_area,
         profit_km2 = profit/water_area)

# mean_catch_global <- mean(harmonized_threats %>% filter(catch_km2>0) %>% pull(catch_km2))
# mean_wts <- mean(harmonized_threats %>% filter(weighted_score>0) %>% pull(weighted_score))
# 
# median_catch_global <- median(harmonized_threats %>% filter(catch_km2>0) %>% pull(catch_km2))
# median_wts <- median(harmonized_threats %>% filter(weighted_score>0) %>% pull(weighted_score))

mean_profit_global <- mean(harmonized_threats %>% filter(catch_km2>0) %>% pull(profit_km2))
mean_wts <- mean(harmonized_threats %>% filter(weighted_score>0) %>% pull(weighted_score))

median_profit_global <- median(harmonized_threats %>% filter(catch_km2>0) %>% pull(profit_km2))
median_wts <- median(harmonized_threats %>% filter(weighted_score>0) %>% pull(weighted_score))



harmonized_threats$category <- NA
harmonized_threats <- harmonized_threats %>% 
  mutate(category = if_else(profit_km2 > median_profit_global, 
                            if_else(weighted_score > median_wts, "Fishery competition", "Fishery prioritization"), 
                            if_else(weighted_score > median_wts, "Easy wins", "Area of low concern")))

harmonized_threats$category <- fct_relevel(as.factor(harmonized_threats$category), c("Fishery competition", "Fishery prioritization",  "Area of low concern", "Easy wins"))
harmonized_threats <- harmonized_threats %>% filter(is.na(category)==F)


#Values:

hs_values <- harmonized_threats %>%
  group_by(category) %>%
  summarize(water_area=sum(water_area)) %>%
  mutate(prop_percent=100*water_area/sum(water_area))
write_csv(hs_values, file.path(dir_output, "hs_area_categorization.csv"))

hs_fp <- round(hs_values %>% filter(category=="Fishery prioritization") %>% pull(prop_percent), digits=0)
hs_ew <- round(hs_values %>% filter(category=="Easy wins") %>% pull(prop_percent), digits=0)
hs_aolc <- round(hs_values %>% filter(category=="Area of low concern") %>% pull(prop_percent), digits=0)
hs_fc <- round(hs_values %>% filter(category=="Fishery competition") %>% pull(prop_percent), digits=0)
#However, only a small area of the high seas (~4%) is categorized as 'fishery prioritization' whereas ~28% is an easy win for conservation and another 16% are areas where there are conservation concerns but also valuable fisheries.

text_color <- "grey10"
text_size <- 4
hs_distribution <- harmonized_threats %>% 
  filter(eez_id==0) %>% 
  ggplot(aes(x=weighted_score, y=log10(profit_km2), color=category)) +
  geom_point(alpha=0.3) + 
  geom_hline(yintercept= log10(median_profit_global), lty="dashed") + 
  geom_vline(xintercept= median_wts, lty="dashed") +
  # annotate("text", y = -3, x = 70, label = "Easy wins", size=text_size, color=text_color) +
  # annotate("text", y = 3, x = 70, label = "Fishery competition", size=text_size, color=text_color) +
  # annotate("text", y = 3, x = 3, label = "Fishery prioritization", size=text_size, color=text_color) +
  # annotate("text", y = -3, x = 3, label = "Areas of low concern", size=text_size, color=text_color) +
  labs(color="", x="Weighted threat score", y=expression(paste("Log10(Profit/", km^2, ")"))) + 
  theme(legend.position="none") +
  scale_color_manual(values=c(zissou5[5], zissou5[4], zissou5[2], zissou5[1])) +
  #scale_x_continuous(limits = c(-5,99)) +
  NULL
#hs_distribution
# ggsave(plot=hs_distribution, "./figs/methods_figure/High seas distribution of cells on conceptual diagram.png", dpi=300, width=8, height=4)

harmonized_threats_labeled <- harmonized_threats %>% 
  mutate(category = as.character(category)) %>% 
  mutate(category = 
           if_else(category=="Fishery prioritization", "Fishery prioritization (P)", 
                            if_else(category=="Fishery competition","Fishery competition (C)", 
                                    if_else(category=="Area of low concern", "Area of low concern (L)", "Easy wins (E)"))))
  
harmonized_threats_labeled$category <- as.factor(harmonized_threats_labeled$category)
harmonized_threats_labeled$category <- fct_relevel(as.factor(harmonized_threats_labeled$category), c("Fishery competition (C)", "Fishery prioritization (P)",  "Area of low concern (L)", "Easy wins (E)"))

hs_category_bar <- harmonized_threats_labeled %>% 
  filter(eez_id==0) %>% 
  ggplot(aes(x=category, fill=category)) +
  geom_bar() + 
  labs(fill="", x="", y="Number of cells") + 

  #theme(legend.position="none") +
  scale_fill_manual(values=c(zissou5[5], zissou5[4], zissou5[2], zissou5[1])) +
  #theme(axis.text.x = element_blank()) + 
  scale_x_discrete(labels=c("C", "P", "L", "E")) + 
  scale_y_continuous(expand=c(0,0)) +
  NULL


cowplot::plot_grid(hs_distribution, hs_category_bar, rel_widths = c(1.15,1.0), align="h")
#ggsave("./figs/HS Combined plot.png", dpi=300, width=8, height=4)
if(fig_output==TRUE){
  ggsave(file.path(dir_manuscript_figs, "high-seas.png"), dpi=300, width=8, height=4)
}
```


## Discussion
The United Nations has called for countries to work towards a wide range of Sustainable Development Goals (SDGs). Balancing these SDGs is necessary for the success of fisheries management. Previous research has focused on potential trade-offs between fisheries and conservation and where we can search for win-win situations in these two aims. While it has been shown that often there are benefits to reducing fisheries capacity and fishing to both fisheries [@Sumaila2012] and conservation [@Burgess2018], these benefits are not shared evenly. Reductions in fishing capacity often mean reductions in employment (SDG 8) and seafood supply (SDG 2) [@Cheung2008]. In addition, closing areas to fisheries can force some fishers out with an often unequal distribution of benefits and costs between different sectors (including eco-tourism) and between different fisheries (SDG 10) [@Gill2019; @Cinner2014]. 

The majority of grid cells within the high seas are rated as being of low conservation concern and low fisheries profitability. While there are likely benefits to coastal fisheries from closing the high seas [@Sumaila2015a; @White2014], the conservation benefit for IUCN Red List species is generally low at present. Most of the high seas is categorized as 'areas of low concern' for fisheries and conservation. Only a small area of the high seas (`r toString(hs_fp)`%) is categorized as 'fishery prioritization', and another `r toString(hs_fc)`% are areas where there are conservation concerns but also valuable fisheries. The number of cells that are categorized to be 'conservation prioritization' or 'easy wins' dwarfs the number of cells that are important to fisheries (both 'fishery prioritization' and 'competition'). This may change in the future as fisheries continue to expand offshore. Therefore, if treated as a whole, the benefits to conservation outweigh the benefits to fisheries in the high seas.

This analysis highlights at a broad scale where fisheries or conservation can be prioritized, and where there are competing aims between these areas. Coastal areas are of large importance to fisheries, especially to small-scale fisheries, but coastal areas are also the most biodiverse regions of the marine realm. These areas are generally categorized as 'competition' areas. However, this analysis adds to existing MPA discussions that may lead to less contentious implementation of MPAs where certain fisheries can co-exist depending on the MPA goals (species conservation versus resource conservation) and current fisheries threats. 

Our study is static and focuses on data reflective of the present situation. We therefore do not acount for the future marine spatial planning challenges associated with changing species ranges [@Cheung2009], and the response of fisheries to climate change and changing environmental parameters [@Crespo2018; @Young2019]. The concepts of this study could be incorporated into models that allow for gear substitution to model fisheries adaptation to climate change along a path that reduces impacts on Threatened species.  

Our study may underestimate the impact of some fishing gears based on the descriptions of threats and use for each IUCN species. The study is inherently limited to those species included in the IUCN Red List, as well as to those species that have enough information to be included in the analysis (see supplemental materials). For the species that have gear threat information, it is unlikely these threats are biased towards particular fishing methods as the threats generally highlight all known (fisheries) threats. However, there is known to be a systemic bias taxonomically and geographically for conservation research and species assessed by the Red List [@Donaldson2016]. One area where this is not fully accounted for is the impact of bottom trawls, dredges, and other bottom-impacting gear on seafloor habitat [@CommitteeonEcosystemEffectsofFishing2002], which is not fully captured in the IUCN assessments (supplemental materials). In addition, as Data Deficient species are given a risk score of 0, we likely underestimate the risk to these species. For example, a quarter of Chondrichthyes (sharks, rays, and chimaeras) species currently categorized as data deficient were predicted to be Threatened [@Dulvy2014].

## Conclusion
Our results highlight areas of high conservation concern for particular fishing gears, and areas of high overlap with multiple fishing gear threats and multiple species of conservation concern. We also highlight areas with the potential for low-cost fishing closures leading to maximum protection of species negatively affected by these fishing gears. Interestingly, gillnet fisheries represent a greater opportunity than the often demonized bottom trawl fisheries according to our analysis due to the high fisheries profits derived from many bottom trawl catches. This analysis can help inform future conservation planning with areas of low-cost trade-offs in comparison to areas with much higher costs for equal conservation benefits. 

## Acknowledgements
TC acknowledges funding support of the Social Sciences and Humanities Research Council of Canada and the Four Year Fellowship from the University of British Columbia. DP Acknowledges support from the *Sea Around Us*, which is funded by a number of philanthropic foundations.


## References
