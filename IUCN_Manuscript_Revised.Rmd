---
title: "Low cost conservation: Fishing gear threats to marine species"
author: "Tim Cashion^1^, Travis C. Tai^1,2^, Vicky W.Y. Lam^1,2^, Daniel Pauly^3^, and U. Rashid Sumaila^1,4^"
date: "`r date()`"
output: 
  bookdown::html_document2:
    default
  # bookdown::word_document2:
  #   default
bibliography: MyCollection.bib
always_allow_html: yes
csl: science.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=F, warning=F)
source("./R/common_fxns.R")
#biblio-style: "apalike"
packages <- c("tidyverse", 
              "rgdal",
              "wesanderson",
              "parallel",
              "bookdown",
              "cowplot",
              "knitr"
              )
ipak(packages)

####Directories####
dir_data <- "./data"
dir_spatial <- "./spatial"
dir_figs <- "./figs"
dir_manuscript_figs <- "./figs/manuscript_figs"
dir_supplemental_figs <- "./figs/supplemental_figs"
dir_spatial_csvs <- "./spatial/csvs"
dir_rasters <- "./spatial/spp_rasters"
dir_output <- "./output"


fig_output <- TRUE
if(fig_output==TRUE){ #Erase existing manuscript figs and re-output
  unlink(paste("./figs/manuscript_figs/", list.files("./figs/manuscript_figs"), sep=""))
}

```

```{r plot-aes}
pal <- wes_palette(name = "Zissou1", n=100, type = c("continuous"))
zissou5 <- wes_palette(name="Zissou1")


theme_set(theme_classic())

cont_fill = 'white'#'grey30' #'grey80'
back_fill =  'white'#'#202A50' #'black' #'#1F2A4F'
cont_color = 'grey60'#'grey30'
#color_grad = c( "#414487", "#2A788E", "#22A884", "#7AD151","#FDE725","#FFC04C")
color_grad = c("#C6DBEF", "#9ECAE1", "#6BAED6","#4292C6" ,"#2171B5", "#084594") #blues
null_colour <- "white"

```

```{r body-data}

#Establish list of marine species 
all_species <- data.table::fread(file.path(dir_data, paste( "iucn_species_list_", api_version,".csv", sep="")))

marine_species <- read.csv(file.path(dir_data, paste( "spp_marine_from_", api_version,".csv", sep="")))
#### Align with threats and narrative text: ####
species_threats <- read.csv(file.path(dir_data, "species_fishing_threats.csv"), stringsAsFactors = F)
colnames(species_threats) <- gsub(colnames(species_threats), pattern="result\\.", replacement="")
risk_codes <- read.csv(file.path(dir_data, "risk_code_lookup.csv"), stringsAsFactors = F)
species_threats <- species_threats %>% left_join(risk_codes, by=c("category"="code"))
species_threats <- species_threats %>%
  dplyr::select(iucn_sid, class_name, scientific_name, code_current, cat_score) %>%
  unique()


# threatened_status <- c("VU", "CR", "EN")
# species_threats <- species_threats %>% filter(code_current %in% threatened_status)
text_threats <- read_csv(file.path(dir_data, "narrative_threats_output_tidy.csv"))

cell_size <- "05"

spat_files <- list.files(file.path(paste(dir_rasters, "_", cell_size, sep="")))
spat_files <- spat_files[spat_files != "desktop.ini"]
raster_read <- function(filename){
  id <- gsub(filename, pattern="iucn_sid_", replacement = "")
  id <- gsub(id, pattern=".csv", replacement = "")
  spp_rast <- data.table::fread(file.path(paste(dir_rasters, "_", cell_size, sep=""), filename))
  if(nrow(spp_rast)>0){
    spp_rast$iucn_sid <- as.numeric(id)
    return(spp_rast)
  }
}
# spat_list <- parallel::mclapply(spat_files, raster_read)
# spat_list <- bind_rows(spat_list)
# write_csv(spat_list, file.path(dir_data, "spat_list.csv"))
spat_list <- data.table::fread(file.path(dir_data, "spat_list.csv"))

#Get cell ids to match to lon, lat, and water area
# cell_ids <- read.csv(file.path(dir_spatial_csvs, "cell_ids.txt"), header=F, col.names = c("cell_id", "lon", "lat"))
# cell_id_area <- data.table::fread(file.path(dir_spatial_csvs, "cell_id_area_05.csv"))
cell_ids <- read.csv(file.path(dir_spatial_csvs, "cell_id_lon_lat_area.csv"))


# allocated_gear_value <- data.table::fread(file.path(dir_data, "allocated_super_gear_value.csv"))
# allocated_gear_value <- allocated_gear_value %>% 
#   left_join(cell_ids) %>% 
#   left_join(cell_id_area) %>% 
#   mutate(value_km2 = mean_value/water_area)

allocated_gear_profit <- data.table::fread(file.path(dir_data, "allocated_super_gear_profit.csv"))
allocated_gear_profit <- allocated_gear_profit %>% 
  left_join(cell_ids) %>% 
  mutate(water_area = ifelse(water_area==0, 1, water_area)) %>% 
  #left_join(cell_id_area) %>% 
  mutate(catch_km2 = mean_catch/water_area,
         profit_km2 = mean_profit/water_area)

spat_data <- spat_list %>% 
  left_join(cell_ids, by="cell_id") %>%
  mutate(category = if_else(is.na(rgn_category), global_category, rgn_category)) %>% 
  left_join(risk_codes %>% dplyr::select(-c(category)), by=c("category"="code"))

```

Affiliations:  
^1^ Fisheries Economics Research Unit, Institute for the Oceans and Fisheries, University of British Columbia.   
^2^ Changing Oceans Research Unit, Institute for the Oceans and Fisheries, University of British Columbia.   
^3^ *Sea Around Us*, Institute for the Oceans and Fisheries, University of British Columbia.   
^4^ School of Public Policy and Global Affairs, University of British Columbia.   
\*t.cashion@oceans.ubc.ca   

Sentence summary: Fishing gear specific threats to marine species demonstrates lower-cost trade-offs between fisheries and conservation goals. 

## Abstract  
Understanding conflicts between objectives of fisheries and conservation is the key to finding win-win situations for marine biodiversity and fishers. Many marine species are threatened by harmful interactions with fisheries, but the threats they face are associated with the fishing gears used. Here, we undertake a novel analysis of marine species and their gear-specific threats to evaluate conservation-fisheries trade-offs to identify areas with high competing goals. Our analysis suggests that gillnet and longline fisheries pose the greatest risk to marine species yet deliver relatively low profits, emphasizing the inefficiencies of these gears. We find that the majority of the high seas has low economic fisheries benefits with over 25% of the high seas categorized as areas of ‘conservation prioritisation’ over fisheries.

Keywords: fishing method, IUCN, fishing pressure, conservation

## Introduction

```{r body-text-values}
iucn_species <- data.table::fread(file.path(dir_data, paste("iucn_species_list_", api_version, ".csv", sep="")))
iucn_species <- iucn_species %>% select(result.taxonid, result.scientific_name) %>% distinct()
unique_species <- length(iucn_species %>% pull(result.scientific_name) %>% unique())

iucn_marine_num <- data.table::fread(file.path(dir_data, paste("spp_marine_from_", api_version, ".csv", sep="")))
iucn_marine_num <- length(iucn_marine_num %>% left_join(iucn_species, by=c("iucn_sid"="result.taxonid")) %>% pull(result.scientific_name) %>% unique())


fishing_threat_num <- length(data.table::fread(file.path(dir_data, "species_fishing_threats.csv")) 
                             %>% filter(code=="5.4") 
                             %>% pull(result.scientific_name) 
                             %>% unique())


iucn_species <- all_species %>% dplyr::select(result.taxonid, result.category)
risk_codes <- read.csv(file.path(dir_data, "risk_code_lookup.csv"), stringsAsFactors = F)
iucn_species <- iucn_species %>% left_join(risk_codes, by=c("result.category"="code"))

gear_threat_num <- length(data.table::fread(file.path(dir_data, "narrative_threats_output_tidy.csv")) %>% 
  filter(!super_code %in% 'trawlers') %>% 
  left_join(iucn_species , by=c("iucn_sid"="result.taxonid")) %>% 
  filter(code_current != "EX") %>% 
  pull(scientific_name) %>% 
  unique()
  )

trawler_unspec_num <- length(text_threats %>% filter(super_code =="trawl unspec") %>% pull(scientific_name) %>% unique())

spatial_data_species_num <- spat_data %>% 
  select(iucn_sid) %>% 
  distinct() %>% 
  left_join(text_threats) %>% 
  filter(is.na(scientific_name)==F) %>% 
  #left_join(all_species, by=c("iucn_sid"="result.taxonid")) %>% 
  #pull(result.scientific_name) %>% 
  pull(scientific_name) %>% 
  unique() %>% 
  length()

#Numbers used in text
fishing_threat_perc <- round(fishing_threat_num/iucn_marine_num * 100, 1)
iucn_marine_num <- prettyNum(iucn_marine_num, big.mark = ",")
fishing_threat_num <- prettyNum(fishing_threat_num, big.mark = ",")
gear_threat_num <- prettyNum(gear_threat_num, big.mark = ",")
spatial_data_species_num <- prettyNum(spatial_data_species_num, big.mark = ",")
```

Fishing is a major threat to many marine species globally [@Jackson2001]. However, different fishing gears are heterogeneous in their spatial extent and their impacts on different species. Therefore, treating different fisheries homogenously with regard to their spatial management likely causes unnecessary conflict between fisheries and conservation priorities, and may impose too high costs without necessarily achieving their intended conservation goals. Here, we aim to understand the threats due to specific fishing gears and their spatial overlap with species of conservation concern. Recent studies have highlighted the spatial extent of fisheries [@Kroodsma2018a; @Amoroso2018], as well as the fisheries risk to species of conservation concern [@Queiroz2019]. While fisheries pose obvious risks to both targeted and bycatch species [@Lewison2004], they also provide livelihoods and food security to millions and billions, respectively [@FAO2018]. Thus, the goals of fisheries and conservation ought to be balanced to minimize the costs and maximize the benefits where possible. 

Trade-offs, such as those between fisheries and conservation, are increasingly important to consider and analyze for marine spatial planning as multiple sectors need to be taken into account. For example, White et al. [-@White2012] evaluated the trade-offs necessary when implementing ocean-based wind turbines that limit access to others sectors such as tourism (e.g., whale watching) and fisheries. However, when considered as a whole, the placement of these turbines can be done in a way that increases the value of the area as a whole while minimizing losses for certain sectors [@White2012]. 

Previous analyses have demonstrated these trade-offs between fisheries and ecosystem health [@Cheung2008]. However, win-win situations are often shown to occur in overly simplified models that do not account for all variables such as employment for fishers [@Cheung2008] or spillover impacts to other areas of importance [@McShane2011]. It is therefore important to consider the different scales at which these conservation plans act and the implicit trade-offs between social and ecological outcomes in many fisheries management plans [@McShane2011]. In addition, taking the heterogeneity of fisheries into account can lead to more positive fishery outcomes without compromising conservation goals [@Klein2010]. 

Trade-off analysis is especially important in areas where the units are not directly comparable. Protecting species of conservation concern from their fisheries threats is one such case where fisheries are valuable for their contribution to livelihoods and food security [@FAO2016b], while protecting marine biodiversity is important for its contribution to various ecosystem services including fisheries production, tourism, and other regulating services [@Beaumont2008; @Assessment2005]. These trade-offs can often be managed through marine spatial planning or other forms of spatial management. Ideally, this can allow different sectors to thrive in their optimal areas while restricting them from operating in the optimal areas for other sectors, which is necessary for managing conflicts between different stakeholders and resource users. 

Here, we establish the first estimate of large-scale conservation trade-offs when protecting species from their major fishing gear threats. This analysis is based on `r gear_threat_num` marine species included in the International Union for the Conservation of Nature (IUCN) Red List with *specific* fishing gears listed as threats. We use species' distribution range maps with their threat status [@IUCN2019] (for the `r spatial_data_species_num` out of `r gear_threat_num` with distribution maps and gear threats) and combine them with a spatialized fisheries catch by gear database [@Pauly2015]. We use gear threats by species described by the IUCN, and weight IUCN conservation status on a linear scale to adapt the biodiversity risk score [@OHara2019] as an 'average' threat status of marine species within an area *by fishing gear*. We also use a weighted threat score based on these same criteria but not scaled by the number of species for all marine areas of the world (Table S1). These two metrics evaluate the average threat status of marine species (biodiversity risk score) and the total threat to marine species (weighted threat score) in a given area. We then combine this with fisheries catch and profit data by gear type to highlight areas with low-cost trade-offs between fisheries and conservation, and areas of high conservation concern that are also highly important to fisheries where there is likely to be competition between fisheries and conservation objectives. 

## Results

### Fishing threats to IUCN species
For the `r iucn_marine_num` marine species included on the IUCN Red List, fishing is identified by the IUCN as a threat to `r fishing_threat_num` of them (`r fishing_threat_perc`%) (Threat category 5.4: fishing and harvesting aquatic resources). This threat is from both large- and small-scale sectors, and from intentional and unintentional capture (i.e., by-catch, Figure \@ref(fig:iucn-fig-combined-plot)A). According to the identified threats, the small-scale sector is a threat to a greater number of species than intentional or unintentional capture by the large-scale sector. Interestingly, the impacts of fishing are identified to be low or unknown on most of the species, whereas medium or high fishing impacts are identified for only very few species. 

```{r fishing-threat}

# fig.cap="Threat to species by level of impact and IUCN fisheries impact category", fig.width=8

fishing_threats <- read.csv(file.path(dir_data, "species_fishing_threats.csv"))
colnames(fishing_threats) <- gsub(colnames(fishing_threats), pattern="result\\.", replacement="")
fishing_threats$title <- gsub(fishing_threats$title, pattern=" \\[harvest\\]", replacement = "")
fishing_threats$score_numeric <- gsub(fishing_threats$score, pattern=".*\\: ", replacement="")
fishing_threats$score_numeric <- as.numeric(fishing_threats$score_numeric)
fishing_threats$score <- gsub(fishing_threats$score, pattern="\\: .*", replacement="")
fishing_threats$score[fishing_threats$score=="Past Impact"] <- "No/Negligible Impact"
fishing_threats$score[fishing_threats$score=="(Not specified)"] <- "Unknown"
fishing_threats$score[is.na(fishing_threats$score)] <- "Unknown"
fishing_threats$score <- fct_relevel(fishing_threats$score, c("No/Negligible Impact", "Unknown", "Low Impact", "Medium Impact", "High Impact"))

fishing_threats$title <- gsub(fishing_threats$title, pattern=": ", replacement=":\n")

fishing_threats_plot <- fishing_threats %>% 
  filter(code != "5.4") %>% 
  group_by(title, score) %>% 
  summarize(Count=n()) %>% 
  ungroup() %>% 
  mutate(title = fct_reorder(title, Count)) %>% 
  ggplot(aes(x=title, y=Count, fill=score)) +
  scale_fill_manual(values=zissou5) + 
  geom_col() + 
  coord_flip() +
  xlab("Threat") +
  ylab("Number of species") + 
  labs(fill="Level of impact") +
  scale_x_discrete(expand=c(0,0)) +
  scale_y_continuous(expand=c(0,0)) +
  theme(axis.text.y = element_text(size=12),
      axis.title.y = element_text(size=12),
      legend.text =  element_text(size=12),
      legend.title =  element_text(size=12)) +
  NULL
# fishing_threats_plot
# if(fig_output==TRUE){
#   ggsave(file.path(dir_manuscript_figs, "fishing-threat.png"), dpi=300, width=8)
# }
```

Within the Red List, trawls are identified as a gear threat for more than 2,500 marine species (Figure \@ref(fig:iucn-fig-combined-plot)B). While many of the species caught by this gear type have an elevated risk of extinction (Near Threatened and higher), most are either Least Concern or Data Deficient within these gear types. The ‘gear types’ that appear in most species threat description are generally more vague gear terms (e.g., ‘trawls’ and ‘nets’) and could be attributable to several types of fishing gear (e.g., trawl nets, gillnets, seine nets all fall under ‘nets’). The more specific gear categories identified are used in the remaining parts of the analysis (Table S2). 


```{r gear-threats}
text_threats <- read.csv(file.path(dir_data, "narrative_threats_output_tidy.csv"))

exclude <- "trawlers"

iucn_cols <- IUCNpalette::iucn_palette(category="All", exclude=c("NE", "CO")) 

iucn_species <- all_species %>% dplyr::select(result.taxonid, result.category)
risk_codes <- read.csv(file.path(dir_data, "risk_code_lookup.csv"), stringsAsFactors = F)
iucn_species <- iucn_species %>% left_join(risk_codes, by=c("result.category"="code"))

gear_terms_threats_plot_n <- text_threats %>% 
  filter(!super_code %in% exclude) %>% 
  left_join(iucn_species , by=c("iucn_sid"="result.taxonid")) %>% 
  filter(code_current != "EX") %>% 
  pull(scientific_name) %>% 
  unique() %>% 
  length()


gear_threat_num <- gear_terms_threats_plot_n

gear_terms_threats_plot <- text_threats %>% 
  filter(!super_code %in% exclude) %>% 
  left_join(iucn_species , by=c("iucn_sid"="result.taxonid")) %>% 
  filter(code_current != "EX") %>% 
  group_by(super_code, code_current) %>% 
  summarize(Count=sum(threat)) %>% 
  ungroup() %>% 
  group_by(super_code) %>% 
  mutate(Total=sum(Count)) %>% 
  ungroup() %>% 
  mutate(super_code = fct_reorder(str_to_sentence(super_code), Total)) %>% 
  mutate(code_current = fct_relevel(code_current, c("DD", "LC", "NT", "VU", "EN", "CR", "EX"))) %>% 
  mutate(code_current = fct_relevel(code_current, rev(c("DD", "LC", "NT", "VU", "EN", "CR", "EX")))) %>% 
  ggplot(aes(x=super_code, y=Count, fill=code_current)) +
  geom_col() + 
  coord_flip() +
  xlab("Fishing gear threat") +
  ylab("Number of species") + 
  labs(fill="IUCN category") + 
  scale_fill_manual(values = rev(iucn_cols)) +
  scale_x_discrete(expand=c(0,0)) +
  scale_y_continuous(expand=c(0,0)) +
  theme(axis.text.y = element_text(size=12),
        axis.title.y = element_text(size=12),
        legend.text =  element_text(size=12),
        legend.title =  element_text(size=12)) +
  NULL
# 
if(fig_output==TRUE){
  ggsave(file.path(dir_manuscript_figs, "gear-threats.png"),
         plot=gear_terms_threats_plot,
         dpi=300)
}
```

From the gear types we have previously identified (Figure \@ref(fig:iucn-fig-combined-plot)C) we see again that bottom trawl fisheries are associated with the largest number of Red List species. However, we see these species are mainly in the Data Deficient, Least Concern, and Near Threatened categories while gillnet gears have the most number of species in the Threatened categories (Vulnerable, Endangered, and Critically Endangered).  

```{r gear-threat-col-chart}

text_threats <- read.csv(file.path(dir_data, "narrative_threats_output_tidy.csv")) 

weighted_gear_threats <- left_join(species_threats, text_threats)
weighted_gear_threats <- weighted_gear_threats %>% 
  mutate(gear_threat = threat*cat_score) %>% 
  filter(is.na(super_code)==F)
  

weighted_gear_threats <- weighted_gear_threats %>% 
  mutate(gear_threat = threat*cat_score)
gears_to_include <- c("Bottom trawl", "Purse seine", "Longline", "Small scale", "Gillnet")

weighted_gear_threats_n <- weighted_gear_threats %>% 
  filter(super_code %in% str_to_lower(gears_to_include)) %>% 
  pull(scientific_name) %>% 
  unique() %>% 
  length()

weighted_gear_threats_plot2 <- weighted_gear_threats %>% 
  group_by(super_code, code_current) %>% 
  summarize(Count=sum(threat, na.rm=TRUE)) %>% 
  ungroup() %>% 
  mutate(super_code = fct_reorder(str_to_sentence(super_code), Count)) %>% 
  mutate(code_current = fct_relevel(code_current, c("DD", "LC", "NT", "VU", "EN", "CR", "EX"))) %>% 
  filter(super_code %in% gears_to_include) %>% 
  ggplot(aes(x=super_code, y=Count, fill=super_code)) +
  geom_col() + 
  xlab("") +
  ylab("Number of species") + 
  labs(fill="Gear type") + 
  facet_wrap(~code_current, nrow=1) + 
  theme(strip.text = element_text(size=12), 
        #strip.background =element_rect(fill=iucn_cols),
        axis.text.x=element_blank(), 
        axis.text.y = element_text(size=12),
        axis.title.y = element_text(size=12),
        legend.text =  element_text(size=12),
        legend.title =  element_text(size=12)) +
  #theme(strip.background = element_rect(fill=iucn_cols), strip.text = element_text(), axis.text.x=element_blank()) + #Fill by IUCN category is quite complicated. Leaving this for now. 
  scale_fill_manual(values = wes_palette("Darjeeling2")) +
  #scale_fill_manual(values = c("#A6C3DD", "#F6D5B9", "#FFFF00")) +
  scale_x_discrete(expand=c(0,0)) +
  scale_y_continuous(expand=c(0,0)) +
  NULL

if(fig_output==TRUE){
  ggsave(file.path(dir_manuscript_figs, "gear-threat-col-chart.png"), plot=weighted_gear_threats_plot2, dpi=300, width=10, height=5)
}

```


```{r harmonized-threats-data}
files <- list.files(dir_output)[grepl(list.files(dir_output), pattern="_SAU_IUCN_threat_05.csv")]

files <- file.path(dir_output, files)
harmonized_list <- lapply(files, data.table::fread)
harmonized_threats <- bind_rows(harmonized_list)
harmonized_threats <- harmonized_threats %>% group_by(lon, lat) %>% 
  summarize(profit = sum(profit, na.rm=TRUE),
            catch=sum(catch, na.rm=TRUE),
            n=sum(n, na.rm=TRUE),
            weighted_score=sum(weighted_score, na.rm=TRUE)) %>% 
  ungroup() %>% 
  mutate(weighted_score_norm = 100*(weighted_score/max(weighted_score)))

```


```{r gear-measures-summary}
sau_gear_types <- unique(allocated_gear_profit$super_code)
iucn_gear_types <- unique(text_threats$super_code)
gear_types <- iucn_gear_types[grep(iucn_gear_types, pattern=paste(sau_gear_types, collapse="|"))]

gear_threats <- spat_data %>% 
  left_join(text_threats) %>% 
  group_by(lon, lat, super_code) %>% 
  summarize(n = sum(presence, na.rm = T),
            weighted_score = sum(cat_score, na.rm = T)) %>% 
  ungroup()

density_data <- full_join(allocated_gear_profit, gear_threats) %>% 
  filter(super_code != "other") %>% 
  filter(super_code %in% gear_types) %>% 
  mutate(weighted_score = ifelse(is.na(weighted_score), 0, weighted_score),
         profit_km2 = ifelse(is.na(profit_km2), 0, profit_km2),
         n = ifelse(is.na(n), 0, n)) %>% 
  mutate(super_code = fct_drop(super_code)) %>% 
  mutate(profit_km2_per_n = profit_km2/n,
         profit_km2_per_weight = profit_km2/weighted_score,
         score_per_dollar = weighted_score/profit_km2,
         profit_per_tonne = mean_profit/mean_catch)

mean_vals <- density_data %>% 
  filter(super_code != "drifting longlines") %>% 
  group_by(super_code) %>% 
  summarize(mean_profit = mean(profit_km2, na.rm=TRUE))
  
profit_per_tonne_histograms <- density_data %>% 
  filter(super_code != "drifting longlines") %>% 
  ggplot(aes(x=profit_per_tonne)) + 
  geom_histogram(bins =50) + 
  #geom_density() + 
  scale_x_continuous(limits = c(-5000, 12000)) + 
  facet_wrap(~str_to_sentence(super_code)) + 
  geom_vline(data=mean_vals, aes(xintercept = mean_profit), lty='dashed', color='black') + 
  xlab("Estimated Profits ($)/ Tonne") +
  ylab("Frequency") + 
  NULL
#profit_per_tonne_histograms


#Summary table
summary_tab_mean <- density_data %>% 
  filter(is.na(mean_profit)==F & is.na(weighted_score)==F) %>% 
  group_by(super_code) %>% 
  mutate(biodiv_risk = weighted_score/n) %>% 
  summarize(profit_sd = round(sd(profit_km2),2),
            profit_km2 = round(mean(profit_km2),2),
            n_sd = round(sd(n),1),
            n = round(mean(n),1), 
            weighted_score_sd = round(sd(weighted_score),2),
            weighted_score = round(mean(weighted_score),2),
            biodiv_risk_sd = round(sd(biodiv_risk, na.rm=TRUE),2),
            biodiv_risk = round(mean(biodiv_risk, na.rm=TRUE),2)) 


#What are the min and max values for profits. 
# density_data %>%
#   group_by(super_code) %>%
#   summarize(max_prof = max(profit_km2),
#           min_prof = min(profit_km2))


summary_tab_median <- density_data %>% 
  filter(is.na(mean_profit)==F & is.na(weighted_score)==F) %>% 
  group_by(super_code) %>% 
  mutate(biodiv_risk = weighted_score/n) %>% 
  summarize(profit_km2 = round(median(profit_km2),2),
            n = round(median(n),1), 
            weighted_score = round(median(weighted_score),2),
            biodiv_risk = round(median(biodiv_risk, na.rm=TRUE),2)) 

#  mutate(profit_km2_per_weight = round(profit_km2/weighted_score,2))
#Text values:
#Mean and median by gear type
bt_profit <- round(summary_tab_mean %>% filter(super_code=="bottom trawl") %>% pull(profit_km2),0)
bt_risk <- summary_tab_mean %>% filter(super_code=="bottom trawl") %>% pull(biodiv_risk)
bt_n <- round(summary_tab_mean %>% filter(super_code=="bottom trawl") %>% pull(n), 0)

ll_profit <- round(summary_tab_mean %>% filter(super_code=="longline") %>% pull(profit_km2),0)
ll_risk <- summary_tab_mean %>% filter(super_code=="longline") %>% pull(biodiv_risk)
pt_profit <- round(summary_tab_mean %>% filter(super_code=="pelagic trawl") %>% pull(profit_km2),0)


summary_tab_mean <- summary_tab_mean %>% 
  mutate(profit_km2 = paste0(profit_km2, " (", profit_sd, ")"),
         n = paste0(n, " (", n_sd, ")"),
         weighted_score = paste0(weighted_score, " (", weighted_score_sd, ")"),
         biodiv_risk = paste0(biodiv_risk, " (", biodiv_risk_sd, ")")
         )
summary_tab_mean <- summary_tab_mean %>% 
  select(-c(colnames(summary_tab_mean)[grepl(colnames(summary_tab_mean), pattern="_sd")]))

summary_tab_mean <- summary_tab_mean %>% 
  mutate(super_code = str_to_sentence(super_code))
colnames(summary_tab_mean) <- c("Gear type", "Profit ($/km^2^)", "Number of species", "Weighted Threat Score", "Biodiversity Risk Score")


```
### Profits of fishing fleets
Our estimates of profits by fishing fleet vary between fleets as well as geographically (Supplemental figures). Overall, most fleets profits have a roughly normal distribution with a mean near 0 and values extending into large negative values as well as large positive values (Figure S5). While the result of some areas having negative profits may seem counterintuitive, this is to be expected given heterogeneity of fisheries, especially spatially. This finding is also supported by economic theory where profits of open-access fisheries are expected to be 0 [@Gordon1954]. Our profit results are driven by the total revenues from each gear type in each 0.5° by 0.5° cell minus the average cost of operating these gears by each country. In this way, these estimates give a valid approximation of the spatial value of fisheries benefits.  

### Low-cost solutions to gear threats and conservation

Globally, annual fisheries profits by bottom trawl fisheries are estimated to be at an average of \$`r toString(bt_profit)` real USD per km^2^ of area fished (Table \@ref(tab:gear-summary-table)). However, an average of `r toString(bt_n)` species are targeted by bottom trawls in each of the half degree by half degree grids cells with this gear, with an average biodiversity risk score of Near Threatened (`r toString(bt_risk)`). Taken together, the generally high value of their catches make them perform relatively well when considering their average biodiversity risk score and their profits together. In contrast, longline fisheries have low profits per area occupied (\$`r toString(ll_profit)`) as they fish over a large spatial area. While they operate in areas with a similar biodiversity risk score as bottom trawl fisheries (`r toString(ll_risk)`), they do so with much lower returns meaning they produce less fisheries profits for their relative conservations risk (weighted threat score) than bottom trawl fisheries. It is important to note that these profits are taken based on the estimated revenues and costs of these fishing vessels, without taking into account subsidies. Therefore, the private profits for these fisheries are higher than shown here. 

We divided the global ocean into half degree by half degree grid cells. If we consider each cell in the grid as independently managed, we can examine the trade-offs in each cell based on its fisheries profits and conservation value (Figure \@ref(fig:conceptual-figure-gears-plot)). Although bottom trawl fisheries operate in many spatial cells of conservation concern (high 'weighted threat score' values), they also generate substantial profits from these fisheries. Gillnets, alternatively, have a large number of cells that are below the median value for fisheries profits and have high weighted threat scores. Pelagic trawls have low weighted threat scores overall and thus the reduction in their use may not lead to large conservation gains. However, pelagic trawls are shown to be non-profitable ($`r toString(pt_profit)`) and it means this gear type is inefficient. Hence, persistent use of this gear type may not be economically beneficial to human well-being. 

These results by gear type also show spatial variability. Longline gears are used for a wide diversity of species and their spatial profitability varies over the globe (Figure 3A). In addition, their weighted threat score shows hotspots in the Mediterranean and the waters surrounding Indonesia  with links between continents from trans-oceanic species such as the oceanic whitetip shark (*Carcharhinus longimanus*) (Figure 3B). The categorization shows large areas of the ocean where fisheries and conservation are both important thus placing them in the ‘competition’ quadrant but many EEZs are categorized as ‘conservation prioritization’ and with the polar areas generally being ‘areas of low concern’ for this gear type (Figure 3C). These results provide a broad view of the trade-offs of protecting species of conservation concern from their gear-specific fisheries threats and the monetary benefits of these fisheries. Broad overviews of conservation-fisheries tradeoffs can guide marine spatial planning efforts, especially in areas with overlapping fishing (and non-fishing) activities. Competition areas and areas closer to the median of the tradeoff analysis (Figure \@ref(fig:conceptual-figure)), will require greater effort and compromise by stakeholders to balance trade-offs. Similar figures for other gear types are available in the supplemental materials.

The six major gear types included here (Table \@ref(tab:gear-summary-table)) together account for 92% of global fisheries catches (landings and discards) [@Cashion2018a]. Bottom trawls, gillnets, and longlines are used in large extent (i.e., have many more cells) where the weighted threat score is higher than the median, especially in contrast to pelagic trawls, purse seines and small-scale gears. Among these higher impact gears, the fisheries profit gained in each grid cell varies substantially. Interestingly, gillnet fisheries are operating in many areas of high conservation concern with fisheries profits below the median value (across gear types). This demonstrates that the social costs of this gear are higher than previously thought [@Chuenpagdee2003], and the social benefit may not be net positive given the relatively low profits achieved (mainly below the median). In contrast, bottom trawl fisheries while overlapping on the weighted threat score dimension with gillnet fisheries, achieve higher profits thus representing a conflict between conservation goals and fisheries goals. Small-scale gears and purse seine have mixed results with weighted threat scores not nearly as high as gillnet or bottom trawls, and a mix of high and low profit areas. Pelagic trawls are often used solely for relatively low-value species (from krill to Alaska pollock), but have very low weighted threat scores throughout their range of fisheries profits. 

```{r conceptual-figure-gears}

sau_gear_types <- unique(allocated_gear_profit$super_code)
iucn_gear_types <- unique(text_threats$super_code)
gear_types <- iucn_gear_types[grep(iucn_gear_types, pattern=paste(sau_gear_types, collapse="|"))]

gear_threats <- spat_data %>% 
  left_join(text_threats) %>% 
  group_by(lon, lat, super_code) %>% 
  summarize(n = sum(presence, na.rm = T),
            weighted_score = sum(cat_score, na.rm = T)) %>% 
  ungroup()

density_data <- full_join(allocated_gear_profit, gear_threats) %>% 
  filter(super_code != "other") %>% 
  filter(super_code %in% gear_types) %>% 
  mutate(super_code = fct_drop(super_code)) %>% 
  mutate(weighted_score = ifelse(is.na(weighted_score), 0, weighted_score),
         profit_km2 = ifelse(is.na(profit_km2), 0, profit_km2),
         n = ifelse(is.na(n), 0, n)) %>% 
  mutate(profit_km2_per_n = profit_km2/n,
         profit_km2_per_weight = profit_km2/weighted_score,
         score_per_dollar = weighted_score/profit_km2) 


plot_data <- density_data %>% 
  filter(super_code != "drifting longlines") %>% 
  mutate(super_code = str_to_sentence(super_code))
#Modified the medians to exclude 0 values. 
median_wts <- median(plot_data %>% filter(weighted_score!=0) %>% pull(weighted_score), na.rm=TRUE) 
median_profitkm2 <- median(plot_data %>% filter(profit_km2!=0) %>% pull(profit_km2), na.rm=TRUE)

line_colour <- "grey50"

```


### Protecting the high seas 
Areas beyond national jurisdiction (i.e., the high seas) have recently received increased attention for their protection for biodiversity and fishery gains [@Sumaila2015a; @White2014], while leading to little losses in terms of food security [@Schiller2018; @Sumaila2007]. According to our framework, the high seas have cells in all four quadrants of our conceptual figure (Fig S2), but the majority are 'areas of low concern' and 'conservation prioritisation' (Figure \@ref(fig:high-seas-plot)). This confirms earlier analyses of the lack of importance of high seas fisheries [@Sumaila2015a; @White2014; @Schiller2018; @Sumaila2007], and although the high seas are dominated by areas of low concern, it has vast amounts that fall into 'conservation prioritisation' with very few cells in fishery prioritisation or fishery competition. Therefore, a relevant question may be reframed from which parts of the high seas should we protect, to which parts of the high seas should remain as fishing areas [@Walters1998] if any? 

```{r high-seas}

#Get cell ids to identify HS areas from EEZs
cell_ids <- read.csv(file.path(dir_spatial_csvs, "cell_id_lon_lat_area.csv"))
cell_ids_eezs <- read.csv(file.path(dir_spatial_csvs, "cell_id_eez_fao_area.csv"))
cell_ids_eezs <- cell_ids_eezs %>% select(-water_area) %>% rename(eez_id=area_id)
cell_ids <- left_join(cell_ids, cell_ids_eezs, by="cell_id")

# cell_size <- "05"
# eez_cell_ids <- read_csv(file.path(dir_spatial_csvs, paste("eez_cell_ids_", cell_size, ".csv", sep="")))
# eez_ids <- read.csv(file.path(dir_spatial_csvs, "eez_ids.csv")) %>% 
#   rename(eez_id = EEZID, eez = Name, entity=Entity) %>% 
#   dplyr::select(eez_id, eez, entity)
# 
# eez_ids <- eez_ids %>% 
#   mutate(eez = gsub(eez, pattern="ô", replacement="o"),
#          entity = gsub(entity, pattern="ô", replacement="o"),
#          eez = gsub(eez, pattern="é", replacement="e"),
#          entity = gsub(entity, pattern="é", replacement="e"))
# 
# 
# cell_ids <- read.csv(file.path(dir_spatial_csvs, "cell_ids.txt"), header=F, col.names = c("cell_id", "lon", "lat"))
# cell_ids_area <- read.csv(file.path(dir_spatial_csvs, paste("cell_id_area_", cell_size,".csv", sep="")))
# cell_ids <- cell_ids %>% left_join(cell_ids_area) %>% left_join(eez_cell_ids) %>% left_join(eez_ids)

# cell_ids <- cell_ids %>% 
#   mutate(eez = ifelse(is.na(eez) & water_area>0, "High seas", eez),
#          entity = ifelse(is.na(entity) & water_area>0, "High seas", entity))


harmonized_threats <- bind_rows(harmonized_list)


# harmonized_threats <- harmonized_threats %>% group_by(lon, lat) %>% 
#   summarize(catch=sum(catch, na.rm=TRUE),
#             n=sum(n, na.rm=TRUE),
#             weighted_score=sum(weighted_score, na.rm=TRUE)) %>% 
#   ungroup() %>% 
#   mutate(weighted_score = 100*(weighted_score/max(weighted_score)))
harmonized_threats <- harmonized_threats %>% left_join(cell_ids)
harmonized_threats <- harmonized_threats %>% 
  mutate(catch_km2 = catch/water_area,
         profit_km2 = profit/water_area)

# mean_catch_global <- mean(harmonized_threats %>% filter(catch_km2>0) %>% pull(catch_km2))
# mean_wts <- mean(harmonized_threats %>% filter(weighted_score>0) %>% pull(weighted_score))
# 
# median_catch_global <- median(harmonized_threats %>% filter(catch_km2>0) %>% pull(catch_km2))
# median_wts <- median(harmonized_threats %>% filter(weighted_score>0) %>% pull(weighted_score))

mean_profit_global <- mean(harmonized_threats %>% filter(catch_km2>0) %>% pull(profit_km2))
mean_wts <- mean(harmonized_threats %>% filter(weighted_score>0) %>% pull(weighted_score))

median_profit_global <- median(harmonized_threats %>% filter(catch_km2>0) %>% pull(profit_km2))
median_wts <- median(harmonized_threats %>% filter(weighted_score>0) %>% pull(weighted_score))



harmonized_threats$category <- NA
harmonized_threats <- harmonized_threats %>% 
  mutate(category = if_else(profit_km2 > median_profit_global, 
                            if_else(weighted_score > median_wts, "Fishery competition", "Fishery prioritisation"), 
                            if_else(weighted_score > median_wts, "Conservation prioritisation", "Area of low concern")))

harmonized_threats$category <- fct_relevel(as.factor(harmonized_threats$category), c("Fishery competition", "Fishery prioritisation",  "Area of low concern", "Conservation prioritisation"))
harmonized_threats <- harmonized_threats %>% filter(is.na(category)==F)


#Values:

hs_values <- harmonized_threats %>%
  group_by(category) %>%
  summarize(water_area=sum(water_area)) %>%
  mutate(prop_percent=100*water_area/sum(water_area))
write_csv(hs_values, file.path(dir_output, "hs_area_categorization.csv"))

hs_fp <- round(hs_values %>% filter(category=="Fishery prioritisation") %>% pull(prop_percent), digits=0)
hs_ew <- round(hs_values %>% filter(category=="Conservation prioritisation") %>% pull(prop_percent), digits=0)
hs_aolc <- round(hs_values %>% filter(category=="Area of low concern") %>% pull(prop_percent), digits=0)
hs_fc <- round(hs_values %>% filter(category=="Fishery competition") %>% pull(prop_percent), digits=0)
#However, only a small area of the high seas (~4%) is categorized as 'fishery prioritisation' whereas ~28% is an easy win for conservation and another 16% are areas where there are conservation concerns but also valuable fisheries.

text_color <- "grey10"
text_size <- 4
hs_distribution <- harmonized_threats %>% 
  filter(eez_id==0) %>% 
  ggplot(aes(x=weighted_score, y=log10(profit_km2), color=category)) +
  geom_point(alpha=0.3) + 
  geom_hline(yintercept= log10(median_profit_global), lty="dashed") + 
  geom_vline(xintercept= median_wts, lty="dashed") +
  # annotate("text", y = -3, x = 70, label = "conservation prioritisation", size=text_size, color=text_color) +
  # annotate("text", y = 3, x = 70, label = "Fishery competition", size=text_size, color=text_color) +
  # annotate("text", y = 3, x = 3, label = "Fishery prioritisation", size=text_size, color=text_color) +
  # annotate("text", y = -3, x = 3, label = "Areas of low concern", size=text_size, color=text_color) +
  labs(color="", x="Weighted threat score", y=expression(paste("Log10(Profit/", km^2, ")"))) + 
  theme(legend.position="none") +
  scale_color_manual(values=c(zissou5[5], zissou5[4], zissou5[2], zissou5[1])) +
  #scale_x_continuous(limits = c(-5,99)) +
  NULL
#hs_distribution
# ggsave(plot=hs_distribution, "./figs/methods_figure/High seas distribution of cells on conceptual diagram.png", dpi=300, width=8, height=4)

harmonized_threats_labeled <- harmonized_threats %>% 
  mutate(category = as.character(category)) %>% 
  mutate(category = 
           if_else(category=="Fishery prioritisation", "Fishery prioritisation (FP)", 
                            if_else(category=="Fishery competition","Fishery competition (C)", 
                                    if_else(category=="Area of low concern", "Area of low concern (L)", "Conservation prioritisation (CP)"))))
  
harmonized_threats_labeled$category <- as.factor(harmonized_threats_labeled$category)
harmonized_threats_labeled$category <- fct_relevel(as.factor(harmonized_threats_labeled$category), c("Fishery competition (C)", "Fishery prioritisation (FP)",  "Area of low concern (L)", "Conservation prioritisation (CP)"))

hs_category_bar <- harmonized_threats_labeled %>% 
  filter(eez_id==0) %>% 
  ggplot(aes(x=category, fill=category)) +
  geom_bar() + 
  labs(fill="", x="", y="Number of cells") + 

  #theme(legend.position="none") +
  scale_fill_manual(values=c(zissou5[5], zissou5[4], zissou5[2], zissou5[1])) +
  #theme(axis.text.x = element_blank()) + 
  scale_x_discrete(labels=c("C", "P", "L", "E")) + 
  scale_y_continuous(expand=c(0,0)) +
  NULL


# cowplot::plot_grid(hs_distribution, hs_category_bar, rel_widths = c(1.15,1.0), align="h")
# #ggsave("./figs/HS Combined plot.png", dpi=300, width=8, height=4)
# if(fig_output==TRUE){
#   ggsave(file.path(dir_manuscript_figs, "high-seas.png"), dpi=300, width=8, height=4)
# }
```


## Discussion
The United Nations has called for countries to work towards a wide range of Sustainable Development Goals (SDGs). In order to achieve SDG 14 (“Life Below Water”), a greater emphasis needs to placed on fisheries management and protecting marine specific of conservation concern. Previous research has focused on potential trade-offs between fisheries and conservation and where we can search for win-win situations in these two objectives. While it has been shown that often there are benefits to reducing fisheries capacity and fishing to both fisheries [@Sumaila2012] and conservation [@Burgess2018], these benefits are not shared evenly. Reductions in fishing capacity often mean reductions in employment (SDG 8) and seafood supply (SDG 2) [@Cheung2008] in the short term [@Sumaila2004]. In addition, closing areas to fisheries can force some fishers out with an often unequal distribution of benefits and costs between different sectors (including eco-tourism) and between different fisheries (SDG 10) [@Gill2019; @Cinner2014]. 

The majority of grid cells within the high seas are rated as being of low conservation concern and low fisheries profitability. While there are likely benefits to coastal fisheries from closing the high seas [@Sumaila2015a; @White2014], the conservation benefit of this measure for IUCN Red List species is currently low. Most of the high seas is currently categorized as 'areas of low concern' for fisheries and conservation. Only a small area of the high seas (`r toString(hs_fp)`%) is currently categorized as 'fishery prioritisation', and another `r toString(hs_fc)`% are areas where there are conservation concerns but also valuable fisheries. The number of cells that are categorized to be 'conservation prioritisation' dwarfs the number of cells that are important to fisheries (combined number of cells categorized as ‘fishery prioritisation’ or ‘competition’). This may change in the future as fisheries continue to expand offshore. Therefore, if treated as a whole, the benefits to conservation outweigh the benefits to fisheries in the high seas.

This analysis highlights at a broad scale where fisheries or conservation can be prioritized, and where there are competing aims between these areas. Coastal areas are of large importance to fisheries, especially to small-scale fisheries, but coastal areas are also the most biodiverse regions of the marine realm. These areas are generally categorized as 'competition' areas. However, this analysis adds to existing MPA discussions that may lead to less contentious implementation of MPAs where certain fisheries can co-exist depending on the MPA goals (species conservation versus resource conservation) and current fisheries threats. 

Our study is static and focuses on data reflective of the present situation. We therefore do not account for the future marine spatial planning challenges associated with changing species ranges [@Cheung2009], and the response of fisheries to climate change and changing environmental parameters [@Crespo2018; @Young2019] and their economic and human consequences [@Sumaila2019]. The concepts of this study could be incorporated into models that allow for gear substitution to model fisheries adaptation to climate change along a path that reduces impacts on Threatened species.  

Our study may underestimate the impact of some fishing gears based on the descriptions of threats and use for each IUCN species. The study is inherently limited to those species included in the IUCN Red List, as well as to those species that have enough information to be included in the analysis (see supplemental materials). For the species that have gear threat information, it is unlikely these threats are biased towards particular fishing methods as the threats generally highlight all known (fisheries) threats. However, there is known to be a systemic bias taxonomically and geographically for conservation research and species assessed by the Red List [@Donaldson2016]. One area where this is not fully accounted for is the impact of bottom trawls, dredges, and other bottom-impacting gear on seafloor habitat [@CommitteeonEcosystemEffectsofFishing2002], which is not fully captured in the IUCN assessments (supplemental materials). In addition, as Data Deficient species are given a risk score of 0, we likely underestimate the risk to these species. For example, a quarter of Chondrichthyes (sharks, rays, and chimaeras) species currently categorized as data deficient were predicted to be Threatened [@Dulvy2014].

## Conclusion
Our results highlight areas of high conservation concern for particular fishing gears, and areas of high overlap between multiple fishing gear threats and multiple species of conservation concern. We also highlight areas with the potential for low-cost fishing closures leading to maximum protection of species negatively affected by these fishing gears. Interestingly, the study suggests that gillnet fisheries represent a greater overall threat than the often criticised bottom trawl fisheries due to the high fisheries profits derived from many bottom trawl catches. This analysis can help inform future conservation planning with areas of low-cost trade-offs in comparison to areas with much higher costs for equal conservation benefits. 

*Acknowledgments:*
*Funding:* TC acknowledges funding support of the Social Sciences and Humanities Research Council of Canada and the Four Year Fellowship from the University of British Columbia. DP acknowledges support from the *Sea Around Us*, which is funded by a number of philanthropic foundations. TCT and URS acknowledge support from the OceanCanada Partnership, funded by the Social Sciences and Humanities Research Council of Canada. URS acknowledges additional funding from the ADM Capital Foundation.
Author contributions: TC led the design and analysis and wrote the original version of the manuscript. T. Tai helped in the early analysis and editing the original manuscript. V. Lam contributed data and expertise on the cost of fishing database, and all authors helped analyse results and edited the final manuscript to its improved form.
*Competing interests:* Authors declare no competing interests.
*Data and materials availability:* Data obtained from the *Sea Around Us*, BirdLife International, and the IUCN Red List are publicly available. All code used for processing this data and producing the results of this manuscript are available at www.github.com/timcashion/iucnfishingthreats.
*Supplementary Materials:*
Materials and Methods
Figures S1-S4
Tables S1-S5
References (XX-XX)

## Figures

```{r iucn-fig-combined-plot, fig.cap= "IUCN fishing gear threats: species categorized by fishing gear threat (A); fishing gear threats by gear types listed (B); and identified gear types by threat status (C). Note: DD: Data Deficient; LC: Least Concern; NT: Near Threatened; VU: Vulnerable; EN: Endangered; CR: Critically Endangered.", fig.height=8, fig.width=12, dpi=400}

#Gear threats across current IUCN Red List status and gear types

cowplot::plot_grid(
  cowplot::plot_grid(fishing_threats_plot,
  gear_terms_threats_plot, nrow=1, labels=c("A", "B")),
  weighted_gear_threats_plot2,
  nrow=2, 
  align = "v",
  rel_widths = c(1, 2),
  rel_heights = 1, 
  labels=c("","C"))

if(fig_output==TRUE){
  ggsave(file.path(dir_manuscript_figs, "Fig1_iucn_panel.png"), height = 8, width=12, dpi=300)
}
```


```{r conceptual-figure-gears-2t, fig.cap="Fisheries profits (log scaled) and weighted score for major gear types. Each point represents a 0.5° by 0.5° cell. Grey dashed lines indicate the median values  (excluding values of 0) across gear types for fisheries profits per km^2^ and weighted threat score. Outer values demonstrate the production frontier.", eval=F}

plot_data %>% 
  ggplot(aes(x=weighted_score, y=profit_km2)) +
  geom_hex() + 
  scale_y_log10() + 
  scale_fill_gradient2(trans = 'log10') + 
  #scale_x_reverse() + 
  ylab(expression(paste("Profit ($/", km^2, ")"))) +
  xlab("Weighted threat score") +
  labs(fill="Count") + 
  facet_wrap(~super_code) + 
  geom_vline(xintercept = median_wts, lty="dashed", color=line_colour) + 
  geom_hline(yintercept = median_profitkm2, lty="dashed", color=line_colour) +
  theme(strip.background = element_blank()) + 
  #theme(legend.position = "none") + 
  NULL

if(fig_output==TRUE){
  ggsave(file.path(dir_manuscript_figs, "Fig2_conceptual-figure-gears.png"), dpi=300)
}
```


```{r conceptual-figure-gears-plot, fig.cap="Fisheries profits (log scaled) and weighted score for major gear types. Each point represents a 0.5° by 0.5° cell. Grey dashed lines indicate the median values  (excluding values of 0) across gear types for fisheries profits per km^2^ and weighted threat score."}

plot_data %>% 
  ggplot(aes(x=weighted_score, y=profit_km2, color=super_code)) +
  geom_point(alpha=0.1) + 
  scale_y_log10() + 
  ylab(expression(paste("Profit ($/", km^2, ")"))) +
  xlab("Weighted threat score") +
  labs(color="Gear type") + 
  facet_wrap(~super_code) + 
  geom_vline(xintercept = median_wts, lty="dashed", color=line_colour) + 
  geom_hline(yintercept = median_profitkm2, lty="dashed", color=line_colour) +
  theme(strip.background = element_blank()) + 
  theme(legend.position = "none") + 
  NULL

if(fig_output==TRUE){
  ggsave(file.path(dir_manuscript_figs, "Fig2_conceptual-figure-gears.png"), dpi=300)
}
```


![Fig 3. Longline: Distribution of profits (A), weighted threat score (B), and categorisation (C).](./figs/supplemental_figs/ll_threats.png)


```{r high-seas-plot, fig.cap="Scatterplot of cells within the High Seas (areas beyond national jurisdiction) according to their categories from our conceptual diagram. Each point is the values for a specific gear type in a 0.5° by 0.5° cell. Dashed lines indicated mean values of all cells (High Seas and EEZs).", fig.width=8}
cowplot::plot_grid(hs_distribution, hs_category_bar, rel_widths = c(1.15,1.0), align="h")
#ggsave("./figs/HS Combined plot.png", dpi=300, width=8, height=4)
if(fig_output==TRUE){
  ggsave(file.path(dir_manuscript_figs, "Fig3_high-seas.png"), dpi=300, width=8, height=4)
}
```


## Tables


```{r gear-summary-table}
knitr::kable(summary_tab_mean, caption= "Mean values of measures of fisheries conservation concern and profit by gear type with standard deviations in brackets. Mean values are average of all 0.5° by 0.5° cells where that gear is present.")
```


# Supplementary Materials (CUT TO SEPARATE FILE)

*This PDF file includes:*  

Materials and Methods  
Supplementary Text  
Figs. S1 to S4  
Tables S1 to S5  


```{r, include=FALSE}
packages <- c("DiagrammeR")
ipak(packages)

```


## Methods
```{r methods-text-values}
iucn_species <- data.table::fread(file.path(dir_data, paste("iucn_species_list_", api_version, ".csv", sep="")))
iucn_species <- iucn_species %>% select(result.taxonid, result.scientific_name) %>% distinct()
unique_species <- length(iucn_species %>% pull(result.scientific_name) %>% unique())

iucn_marine_num <- data.table::fread(file.path(dir_data, paste("spp_marine_from_", api_version, ".csv", sep="")))
iucn_marine_num <- length(iucn_marine_num %>% left_join(iucn_species, by=c("iucn_sid"="result.taxonid")) %>% pull(result.scientific_name) %>% unique())


fishing_threat_num <- length(data.table::fread(file.path(dir_data, "species_fishing_threats.csv")) %>% filter(code=="5.4") %>% left_join(iucn_species, by="result.scientific_name") %>% pull(result.scientific_name) %>% unique())
gear_threat_num <- length(data.table::fread(file.path(dir_data, "narrative_threats_output_tidy.csv")) %>% left_join(iucn_species, by=c("scientific_name"="result.scientific_name")) %>% pull(scientific_name) %>% unique())

text_threats <- read.csv(file.path(dir_data, "narrative_threats_output_tidy.csv")) 
trawler_unspec_num <- length(text_threats %>% filter(super_code =="trawl unspec") %>% pull(scientific_name) %>% unique())

#Numbers used in text
fishing_threat_perc <- round(fishing_threat_num/iucn_marine_num * 100, 1)
iucn_marine_num <- prettyNum(iucn_marine_num, big.mark = ",")
fishing_threat_num <- prettyNum(fishing_threat_num, big.mark = ",")
gear_threat_num <- prettyNum(gear_threat_num, big.mark = ",")

```

### IUCN data 
The International Union for Conservation of Nature (IUCN) maintains the IUCN Red List of Threatened Species (hereafter, ‘Red List’) that documents the population status and threats of species globally. Species (and sub-populations of species) that are assessed by the IUCN are categorised into one of the following in order of increasing conservation threat: Least Concern, Near Threatened, Vulnerable, Endangered, Critically Endangered, and Extinct. A final category exists of ‘Data Deficient’ that indicates there is not enough information to properly assess the population status of a species. Together, Vulnerable, Endangered, and Critically Endangered are often grouped together as ‘Threatened’. In addition to the categorisation of the threat status, the IUCN provides species range maps, detailed description of threats, and other important information on the species included in the Red List.

Red List Categories, spatial habitat maps, identified threats by species, and a description of threats were gathered from the IUCN API version 2019-2 [@IUCN2019]. The known threats to each marine species were extracted from the IUCN API focusing on threats identified in Category 5: Biological Resource Use. The Red List identifies four different types of fisheries impacts from either intentional or unintentional capture/harvest from the large- or small-scale fisheries. These threats are categorised by the IUCN as unknown, past, no, low, medium, or high impact. In addition, the text from the 'Detailed Threats' and 'Use and Trade' sections for each marine species was extracted from the IUCN API. After extracting the description of the species threats and use and trade information, we tokenized (i.e., separated the text into one and two word strings) the text extracting standard stop words and searched for single words and bigrams of fishing gears (e.g., 'bottom trawl' or 'longline', see Table S1). Bigrams were used as they can include more specific gear types than single words alone (e.g., 'bottom trawl' versus 'trawl' and 'purse seine' versus 'seine'). We use the presence of these words within these narrative sections as a proxy for a particular gear being a threat to these species. The labels for different fishing gears analysed are included in Table \@ref(tab:gear-search-table). These were devised to match the IUCN narrative text most closely to relevant *Sea Around Us* gears. 

We accessed spatial species distribution shape files from the Red List for comprehensively assessed groups that include marine organisms [@IUCN2019]. We supplemented this with Bird Life International species distribution files for birds that occur in marine areas [@BirdLifeInternational2018]. Marine molluscs have not been comprehensively assessed (i.e., less than 80% of the species in this group have not been assessed) by the IUCN except for Cone Snails (*Conus* spp.), and this is a gap in our data coverage. We converted the species distribution maps to raster format at various spatial scales to correspond to existing datasets in fisheries research, but used a 0.5° latitude by 0.5° longitude for our analysis as it matches the *Sea Around Us* fisheries catch database. We rasterised the species distribution files following the same process of O'Hara [-@OHara2019].

We used the same prioritisation of species IUCN Categories based on regional assessments where possible as in O'Hara [-@OHara2019]. Here, regional assessments were matched to associated (i.e., overlapping) marine ecoregions [@Spalding2007] that were then associated with their corresponding cells of the spatial grid used. Regional assessments were used in preference of global assessments where possible. 

```{r progressive-refinement-table, fig.cap="Reason for elimination of species from our  final analysis", echo=FALSE, message=F}
#I want to show how we get from all marine species to our narrower list that rely on this habitat to those that we find spatial data for and have fishing gear labelled threats

dir_data <- "./data"
dir_spatial <- "./spatial"

number_iucn_species <- length(data.table::fread(file.path(dir_data, "iucn_species_list_version_2019-2.csv")) %>% pull(result.taxonid) %>% unique())
number_marine_species <- length(data.table::fread(file.path(dir_data, "species_systems.csv")) %>% filter(result.marine_system==TRUE) %>% pull(result.taxonid) %>% unique())
non_marine_species <- number_iucn_species - number_marine_species
number_marine_species_included <- length(data.table::fread(file.path(dir_data, "spp_marine_from_version_2019-2.csv")) %>% pull(iucn_sid) %>% unique())
number_marine_fishing_threats <- length(data.table::fread(file.path(dir_data, "species_fishing_threats.csv")) %>% pull(iucn_sid) %>% unique())


text_threats <- read.csv(file.path(dir_data, "narrative_threats_output_tidy.csv")) 
number_gear_threats <- length(text_threats %>% pull(iucn_sid) %>% unique())

spatial_ids <- gsub(list.files(file.path(dir_spatial, "spp_rasters_05")), pattern=".csv", replacement="")
spatial_ids <- gsub(spatial_ids, pattern="iucn_sid_", replacement="")

number_marine_spatial_files <- length(list.files(file.path(dir_spatial, "spp_rasters_05")))
gear_threats_spatial <- length(text_threats %>% filter(iucn_sid %in% spatial_ids) %>% pull(iucn_sid) %>% unique())
gear_threats_spatial <- prettyNum(gear_threats_spatial, big.mark=",")


```

The Red List contains detailed information on the species system and habitat types. The system assigns species to terrestrial, freshwater, and marine ecosystems (with species able to occur in multiple ecosystems) and this was used to restrict our analysis to marine species. In addition, we restricted those within the marine ecosystem to specific habitats to eliminate species that are not dependent on the marine environment nor likely to be affected by fisheries, following O'Hara et al. [-@OHara2019]. After restricting our analysis to marine dependent species that are threatened by fishing gears and have species range maps available from the IUCN or BirdLife International, our analysis focused on `r gear_threats_spatial` number of species (Fig S3).

### Fisheries data  
The *Sea Around Us* has reconstructed marine fisheries catches for all marine countries and territories from 1950 to present. The process of reconstruction supplements and corrects reported fisheries catches with estimates of known to be overwhelmingly excluded fishing sectors (e.g., artisanal and recreational fishing) and practices (e.g., discarding) [@Zeller2016]. These catches are spatially allocated according to a rule-based assignment and based on known information on where the fishery was operating (within domestic EEZs, foreign EEZs, the high seas, etc.). The spatial scale used is 0.5° latitude by 0.5° longitude.

The reconstructed catches were then assigned to their respective fishing gear types for industrial and small-scale sectors. This process relied on similar methods as the catch reconstructions relying on official catch statistics by gear type, as well as fisheries reports, catch surveys, newspaper articles, and other grey literature. The process by which each countries fishing gear was assigned is documented in Cashion [-@Cashion2018a]. The result is a catch database with gear information included for all catches. 

We used the *Sea Around Us* database (v.47) for catches by gear type [@Pauly2015; @Cashion2018a] and were accessed from the *Sea Around Us* database by the first author. This database includes spatially allocated reconstructed fisheries catches by gear type and taxon for all fishing countries and territories of the world. The spatial scale of this dataset is 0.5° latitude by 0.5° longitude and has been used in many global fisheries studies [@Gremillet2018; @Schiller2018]. 

In addition, we use the corollary Fisheries Economics Research Unit (FERU) ex-vessel price database that includes reported and estimated first-sale prices for all taxa for each fishing country by year [@Tai2017] to incorporate the potential lost revenues for fisheries closures in areas of high biological importance. Revenue is calculated as the ex-vessel price (real 2010 USD per metric tonne) of a specific taxon caught by a country in a given year multiplied by its landings amount in metric tonnes. 

Due to the importance of gear to our analysis, and its importance as a determinant on the ex-vessel price of fish [@Lee2014; @Asche2012; @Mcconnell2000], we modify the ex-vessel prices by a gear multiplier. We determine this gear multiplier through a hedonic pricing model where gear type is an explanatory variable of the ex-vessel fish price. 

We used the U.S. National Marine Fisheries Service annual commercial landings by gear type [@NMFS2017]. We harmonized the gear types listed to match our existing dataset gear types. While this dataset is not representative of global fisheries nor ex-vessel prices for all species, it gives adequate coverage to derive the effect of different gear types used for catching different species and how it modifies ex-vessel prices. 

We then used a fixed-effects model with linear regression to derive the effect of changing gear type on the ex-vessel price $Price_{xyzt}$ for species $x$, gear $y$, in year $t$. We used the natural logarithm of landings and prices as these variables are closer to a normal distribution when log-transformed, and thus reduces potential heteroscedasticity in our residuals. We also use the country, species, and year as explanatory variables to account for other changes in the price both over time  and between these different markets. 

Our regression equation is:

$ln(Price_{xyzt}) = \beta_0 + \beta_1Gear_y + \beta_2ln(L_{xyzt}) + \beta_3Species_x + \beta_4Year_t + \beta_5Country_z$ (1)  

We used the estimated gear-type coefficients as gear specific multipliers $\beta_1_{y}$ that will modify the ex-vessel price of fish caught (Table \@ref(tab:gear-multiplier-table)).

Finally, we used an updated version of FERU's cost of fishing database [@Lam2011] to account for the cost of fishing that varies by country and gear type. Cost of fishing is broken down into its component parts in the database (e.g., fuel, labour, capital, maintenance, etc.), and here we use the total cost by gear type and country per tonne of fish landed ($C_{yz}$). Where the cost of fishing was not available for a particular gear and country, we used the regional average for that gear type, and where this was not possible we used the average cost across gear types for the region. We used the FAO socioeconomic regions for this stage of the analysis [@FAO2017]. We then derive the profit by gear type and country for each cell $i$ , based on the catch by gear type multiplied by the ex-vessel price multiplied by the gear type multiplier ($M_{y}$) minus the cost of fishing for that amount of landings. Therefore, profit (*P*) in cell *i* is equal to: 

$P_{i} = \sum_{x=1}^{x} (L_{xyi} * P_{x} * M_{y}) - (L_{xyi} * C_{y})$ (2)  

Both catch and profits are expressed throughout in tonnes/km^2^ and $/km^2^ calculated based on the water area in each 0.5° by 0.5° cell. We would expect profit to be relatively equal across gear types, as fishers would switch production systems if one was seen as more profitable. However, profit is expected to vary by gear type in practice in regulated fisheries due to restrictions on switching gear types or target species in regulated limited-entry fisheries (i.e., limited license or quota availability). Further, it is likely that it varies in fisheries not regulated by limited entry through high transition costs of switching gear types, which can be further restricted by credit constraints, and distortions from subsidies which are not equal among fleets [@Schuhbauer2017].

Our analysis focuses on the trade-offs among different fisheries with specific gear types. As such, we did not use the Global Fishing Watch data where gear types are often aggregated (bottom and pelagic trawlers grouped together as trawlers), or only represent a narrow subset of the fleet (e.g., drifting longlines instead of all longlines) [@Kroodsma2018a]. While the Global Fishing Watch data covers a large part of the global fishing effort in non-coastal areas (between 50% and 70% in areas greater than 100 nautical miles from land [@Kroodsma2018a]), it does not have the same coverage of vessels. The dataset is biased against small-scale vessels which are not harm-free. 

### Analysis

First, we analysed the major fishing gear threats based on their appearance in the narrative text of the Red List species profiles. We associated these descriptors to their gear types and examined the number of species by Red List Category and weighted threat status by gear type. We used a linearised weighted scoring method to weight the presence of a species by its Red List Category (e.g., 'Least Concern' = 0, 'Endangered'=0.6, etc., Table S2) [@OHara2019]. Older and outdated categories were updated to their current descriptors such as 'Lower Risk/near threatened' to 'Near Threatened'. 

We mapped areas of high fisheries interest and high conservation concern (Figure S2). The areas with high overlap between conservation concern but low fisheries catches and effort are areas that could be fully protected from these threats for the long term (termed here, 'conservation prioritisation'). However, the areas with high overlap of fisheries interest and high conservation concern are where the impacts on species may be greatest both in terms of fisheries threats and the potential benefits for conservation from fisheries closures. We used this categorisation into four quadrants to simply but effectively delineate areas between their contribution to fisheries and their risk to species of conservation concern from fisheries. 

We use three main metrics frequently in our analysis. First, we adapted the biodiversity risk score developed by O'Hara et al. [-@OHara2019]. This indicator is a measure of the average conservation threat status of an area of the marine environment (Equation 1). It is expressed as:

$Biodiversity Risk Score_{a, g} =  \frac{1}{N_{a}}\sum_{i=1}^{N_{a}}s_{i,g}$ (3)   

Where $N$ is number of assessed species in the cell $a$, $s_{i}$ is the linearized Red List Category numeric score ($s$) of species ($i$) threatened by fishing gear ($g$). All biodiversity risk scores are thus values of between 0 and 1 that roughly correspond to the linear Red List Category scale described above (Table \@ref(tab:risk-code-lookup)). Our adaption of this metric limits it to species threatened by a specific fishing gear ($g$). 

Second, we adapt this metric so that it is not normalised to the mean threat in the cell but representative of scale (number of species) and severity (Red List Category) of threat. This metric is named the ‘weighted threat score’ defined as the sum of species present multiplied by their linearized Red List Category numeric score. We do not normalise (divide by the number of species in a given cell) this to highlight areas of conservation concern based on the number of species in that cell in addition to their threat status.

$WeightedThreatScore_{a,i,g} = \sum_{i=1}^{N_{a}}s_{i}$ (4)   

This analysis was conducted in R [@RCoreTeam2017], and used the tidyverse [@Wickham2016], rMarkdown [@Baumer2015], tidytext [@Fay2018]; gridExtra [@Auguie2017]; sf [@Pebesma2019], rgdal [@Pebesma2012], cowplot [@Huber2017a], and wesanderson [@Ram2018] packages. All code and outputs are available at www.github.com/timcashion/iucnfishingthreats.


## Supplemental Text

As our study was restricted to Red List marine species with spatial information, we attempted to ensure this was representative of broader patterns in Red List species. Generally, he breakdown between IUCN categories appears to be quite similar between all marine species and those included in this study (Figure \@ref(fig:iucn-categories)). 


```{r, include=FALSE}
fig_output <- TRUE
# if(fig_output==TRUE){ #Erase existing manuscript figs and re-output
#   #unlink(paste("./figs/supplemental_figs/", list.files("./figs/supplemental_figs"), sep=""))
# }

```

```{r methods-data}

marine_species <- read.csv(file.path(dir_data, paste( "spp_marine_from_", api_version,".csv", sep="")))
risk_codes <- read.csv(file.path(dir_data, "risk_code_lookup.csv"), stringsAsFactors = F)
risk_lookup <- tibble(code_current = c("VU", "CR", "EN", "NT", "LC", "DD", "EX", "NE"),
       cat_current = c("Vulnerable", "Critically Endangered", "Endangered", "Near Threatened", "Least Concern", "Data Deficient", "Extinct", "Not Evaluated"))
risk_codes <- risk_codes %>% left_join(risk_lookup)

species_threats <- read.csv(file.path(dir_data, "species_fishing_threats.csv"), stringsAsFactors = F)
colnames(species_threats) <- gsub(colnames(species_threats), pattern="result\\.", replacement="")
cell_ids <- read.csv(file.path(dir_spatial_csvs, "cell_ids.txt"), header=F, col.names = c("cell_id", "lon", "lat"))
cell_id_area <- data.table::fread(file.path(dir_spatial_csvs, "cell_id_area_05.csv"))

allocated_gear_profit <- data.table::fread(file.path(dir_data, "allocated_super_gear_profit.csv"))
allocated_gear_profit <- allocated_gear_profit %>% 
  left_join(cell_ids) %>% 
  left_join(cell_id_area) %>% 
  mutate(catch_km2 = mean_catch/water_area,
         profit_km2 = mean_profit/water_area)



```



#### Protecting coastal waters

The coastal waters of three EEZs show very different patterns of fishery conservation by gear type (Figure \@ref(fig:eez-protection-gears)). There are many areas where fisheries should be prioritized and other areas where not all fisheries need to be closed to achieve conservation goals. Small scale fisheries show a diversity of scores across these EEZs confirming they are not impactless. Gillnet fisheries have the highest weighted threat score of any gear in each of these EEZs. Bottom trawl fisheries occur in multiple quadrants including many in the fishery prioritisation in China's EEZ waters because of their high profitability and relatively low weighted threat scores in these waters. 


#### Habitat modification
```{r supplemental-text-nums}
text_threats <- read_csv(file.path(dir_data, "narrative_threats_output_tidy.csv"))
trawl_unspec <- text_threats %>% filter(super_code =="trawl unspec") %>% nrow()
trawl_hab <- read_csv(file.path(dir_data, "trawl_habitat_output.csv"))
num_trawl_hab <- nrow(trawl_hab)
num_dynamite <- sum(trawl_hab$dynamite, na.rm=TRUE)
num_destructive <- sum(trawl_hab$destructive, na.rm=TRUE)

```

Of the `r prettyNum(trawl_unspec, big.mark=",")` marine species that have trawling ('trawls unspecified') identified as a threat, only `r toString(num_trawl_hab)` have habitat modification also identified as a threat. When reviewing the threat description for these species, many of them are identified as two separate threats. Only `r toString(num_destructive)` of these have 'destructive fishing practices' identified as a threat. 

## Supplemental Discussion
It is important to caveat our study knowing that we cannot fully account for the current extent of humanity's use of the oceans and this study has focused on fisheries. Small-scale fisheries are critical to coastal livelihoods across the world and must not be compromised by overly broad conservation initiatives, but instead included when implementing actions to improve aspects of ocean health (e.g. [@Halpern2012]). 

In addition, while we use catch and fisheries profits as a proxy for importance, these are not adjusted for their importance to the country (i.e., percentage of GDP from fisheries revenues or percentage of animal protein from locally caught fish), nor do they take into account differences in purchasing power parity where $1000 of fisheries profits is much more valuable in poorer countries than in industrialized countries. 

While O'Hara et al. [-@OHara2019] highlighted areas of conservation need, we identify the areas that would also meet with more or less fisheries overlap and thus competition. In these areas of competition, we assume the placement of marine protected areas (MPAs) would be more contentious due to the reliance on these natural resources. We also highlight areas with a low trade-off between fisheries profits for the most conservation protection where conservation should be prioritized, and that represent potentially easy wins for conservation. 

## Supplemental Figures

Fig. S1.
```{r progressive-refinement, fig.cap="Exclusion reasons for IUCN Red List species for spatial analysis."}
ipak(c("DiagrammeR", "DiagrammeRsvg", "magrittr", "rsvg"))
progressive_refinement <- grViz("digraph flowchart {
      # node definitions with substituted label text()
      node [fontname = Helvetica, shape = rectangle, style=filled]        
      
      node [color=grey]
      tab1 [label = '@@1']
      
      node [color=LightSteelBlue]
      tab2 [label = '@@2']
      
      node [color=grey]
      tab3 [label = '@@3']
      
      node [color=LightSteelBlue]
      tab4 [label = '@@4']

      node [color=grey]
      tab5 [label = '@@5']

      node [color=LightSteelBlue]
      tab6 [label = '@@6']
      
      node [color=grey]
      tab7 [label = '@@7']
    

      # edge definitions with the node IDs
      tab1 -> tab2;
      tab1 -> tab3;
      tab3 -> tab4;
      tab3 -> tab5;
      tab5 -> tab6;
      tab5 -> tab7;
      
      }

      [1]: 'IUCN Red List Species (n = 108,161)'
      [2]: 'Non-marine species (n = 93,290)'
      [3]: 'Marine species (n = 14,871)'
      [4]: 'No fishing gear type data (n= 10,184)'
      [5]: 'Fishing gear type listed in text (n= 4,579)'
      [6]: 'No spatial data (n= 2,461)'
      [7]: 'Has spatial data (n= 2,226)'
      ")
progressive_refinement
if(fig_output==TRUE){
  progressive_refinement %>%
    export_svg %>% 
    charToRaw %>% 
    rsvg_png(width= 2200, height = 800,
      file=file.path(dir_supplemental_figs, "FigS1_progressive_refinement.png"))
}

```


Fig. S2.
\@ref(fig:conceptual-figure)
```{r conceptual-figure, fig.cap="Theoretical basis for competition between fisheries and conservation", dpi=150, fig.width=3.5, fig.height=3.5}

#mod size:
x <- c(seq(-9,9, 1), rep(0,19))
y <- c(rep(0,19),seq(-9,9, 1))
group <- c(rep(0,19),rep(1,19))

df <- tibble(x,y, group)
#V4:
conceptual_figure <- ggplot(data=df, aes(x=x,y=y, group=group)) +
  geom_line(alpha=0.5) +
  theme_classic() + 
  theme(axis.line=element_blank(),axis.text.x=element_blank(),
        axis.text.y=element_blank(),axis.ticks=element_blank(),
        legend.position="none",
        panel.background=element_blank(),panel.border=element_blank(),panel.grid.major=element_blank(),
        panel.grid.minor=element_blank(),plot.background=element_blank()) + 
  ylab("Fishery") + 
  xlab("Conservation") + 
  #scale_x_discrete(position = "top") +
  annotate("text", x = -4, y = -5, label = "Areas of low concern", size=3, color="grey40") + 
  annotate("text", x = -4, y = 5, label = "Fishery prioritisation", size=3, color="grey40") + 
  annotate("text", x = 5, y = 5, label = "Competition", size=3, color="grey40") + 
  annotate("text", x = 5, y = -5, label = "Conservation prioritisation", size=3, color="grey40") + 
  annotate("text", x = -4, y = 9, label = "Low", size=3, color="grey40") + 
  annotate("text", x = 4, y = 9, label = "High", size=3, color="grey40") + 
  annotate("text", x = -9, y = 4, label = "High", size=3, color="grey40") + 
  annotate("text", x = -9, y = -4, label = "Low", size=3, color="grey40") + 
  geom_vline(xintercept = -8, alpha=0.5) + 
  geom_hline(yintercept= 8, alpha=0.5) + 
  NULL
conceptual_figure
if(fig_output==TRUE){
  ggsave(file.path(dir_supplemental_figs, "FigS2_conceptual_figure.png"))
}


```


![Fig. S3. Conceptual methods figure.](./figs/methods_figure/methods_figure1_alt.png)

Fig. S4.
\@ref(fig:iucn-categories)

```{r iucn-categories, fig.cap="IUCN category for all marine species (A) and marine species included in this study (B)", fig.width=8}

#devtools::install_github("timcashion/IUCNpalette") #Requires this palette
library(IUCNpalette)
iucn_species <- read.csv(file.path(dir_data, "iucn_species_list.csv"))
all_species <- iucn_species %>% filter(result.taxonid %in% marine_species$iucn_sid) %>% left_join(risk_codes, by=c("result.category"="code"))
all_species <- all_species  %>% mutate(code_current = fct_relevel(code_current, c("DD", "LC", "NT", "VU", "EN", "CR", "EX"))) 
all_species <- all_species  %>% mutate(cat_current = fct_relevel(cat_current, c("Data Deficient", "Least Concern", "Near Threatened", "Vulnerable", "Endangered", "Critically Endangered", "Extinct"))) 
included_species <- all_species %>% filter(result.taxonid %in% species_threats$iucn_sid)
all_species_plot <- ggplot(data=all_species, aes(x=cat_current, fill=cat_current)) +
  geom_bar() + 
  scale_fill_manual(values= IUCNpalette::iucn_palette(category="All", exclude="NE")) +
  ylab("Number of species") + 
  labs(fill="IUCN Category") + 
  xlab("") + 
  scale_y_continuous(expand=c(0,0)) + 
  theme(legend.position = "none", axis.text.x= element_blank()) + 
  NULL 
included_species_plot <- ggplot(data=included_species, aes(x=cat_current, fill=cat_current)) +
  geom_bar() + 
  scale_fill_manual(values= IUCNpalette::iucn_palette(category="All", exclude="NE")) +
  ylab("") + 
  xlab("") + 
  labs(fill="IUCN Category") + 
  scale_y_continuous(expand=c(0,0)) + 
  theme(legend.position = "none", axis.text.x= element_blank()) + 
  NULL 
species_plot_legend <- get_legend(all_species_plot + theme(legend.position = "right"))
plot_grid(all_species_plot, included_species_plot, species_plot_legend, labels=c("A", "B", ""), align="h", nrow=1, rel_heights = 1, rel_widths = c(1,1,1))

if(fig_output==TRUE){ 
  ggsave(file.path(dir_supplemental_figs, "FigS4_IUCN_status_marine_versus_study.png"), dpi=300, width=6, height=4)
}

```


Fig S5. 
Figure \@ref(fig:profit-per-tonne-histogram)
```{r profit-per-tonne-histogram, fig.cap="Profit estimated per tonne by gear type where every observation is a fishing entity fishing with a gear in a particular area (0.5° by 0.5° cell). Dashed line indicates mean value for gear type.", fig.width=8}
profit_per_tonne_histograms

```

![Fig S6. Bottom trawl: Distribution of profits (A), weighted threat score (B), and categorisation (C).](./figs/supplemental_figs/bt_threats.png)

![Fig S7. Pelagic trawl: Distribution of profits (A), weighted threat score (B), and categorisation (C).](./figs/supplemental_figs/pt_threats.png)

![Fig S8. Gillnet: Distribution of profits (A), weighted threat score (B), and categorisation (C).](./figs/supplemental_figs/gn_threats.png)

![Fig S9. Purse seine: Distribution of profits (A), weighted threat score (B), and categorisation (C).](./figs/supplemental_figs/ps_threats.png)


## Supplemental Tables

Table S1. 
```{r risk-code-lookup}
risk_code_lookup <- read_csv("./data/risk_code_lookup.csv")
colnames(risk_code_lookup) <- c("Former code", "Category", "Current Code", "Category Score")
kable(risk_code_lookup, caption="Weighting of IUCN Categories based on [@OHara2019]")
```

Table S2. 
```{r gear-search-table}
gear_search_table <- read_csv("./output/gear_search_terms_table.csv")
gear_search_table[] <- lapply(gear_search_table, function(x) gsub(x, pattern="\\|", replacement="; "))
kable(gear_search_table, caption="Search terms used for identifying gear types in IUCN narrative text.")
```

Table S3. 
```{r sau-gear-table}
sau_gear_table <- read_csv("./data/sau_gear_table.csv") %>% dplyr::select(-c(gear_id, notes))
sau_gear_table <- sau_gear_table %>% 
  mutate(name = str_to_sentence(name),
         super_code = str_to_sentence(super_code))
colnames(sau_gear_table) <- c("Gear type", "Super code")
kable(sau_gear_table, caption="Gear types identified in the *Sea Around Us* database.")
```

Table S4. 
```{r gear-multiplier-table}
gear_multiplier_table <- read_csv("./data/gear_price_multipliers.csv")
gear_multiplier_table <- gear_multiplier_table %>% 
  mutate(super_code = str_to_sentence(super_code)) %>% 
  mutate(p.value = ifelse(super_code %in% c("Unknown", "Bottom trawl"), "Not Estimated", "***"))

colnames(gear_multiplier_table) <- str_to_title(colnames(gear_multiplier_table))
kable(gear_multiplier_table, caption="Regression results for gear types used and their gear multipliers used", digits=3)



```

Table S5
```{r hs-categorization-table}
hs_categ <- read_csv("./output/hs_area_categorization.csv")
hs_categ$water_area <- round(hs_categ$water_area/1000000,0)

colnames(hs_categ) <- c("Category", "Water Area (million km2)", "Proportion of High Seas (%)")
kable(hs_categ, digits = 1, caption="Area of high seas by categorization")
```

## References

